<div class='modal'>
	<ion-modal-view>
		<main id="messenger-content" cache-view="false" class="pane uguru-view guru-view bg-slate guru-view-mobile full-x" nav-view="active">
			<header>
				<div class='header-nav'>
					<!-- BIND -->
					<!-- should be hidden when no other contacts are available -->
					<a class='header-nav-back mobile-message-options' ng-click='toggleMessageOptions()'>
						<svg viewBox="0 0 100 100">
							<path ng-show='!messageOptionsShown' d="M14,23 L86,23"></path>
							<path d="M14,50 L86,50"></path>
							<path ng-show='!messageOptionsShown' d="M14,77 L86,77"></path>
						</svg>
					</a>

					<a class="header-nav-close header-close" ng-click="messagesModal.hide()">
						<svg viewBox="0 0 100 100">
							<path d="M50,50 L50,14 L50,50 L14,50 L50,50 Z M50,50 L50,86 L50,50 L86,50 L50,50 Z"></path>
						</svg>
					</a>
				</div>
				<h1 class="text-center">{{active_relationship.guru.name}}</h1>
			</header>


			<!-- ngIf: !doneLoading -->
			<section id='message-container'>
				<ul id='messenger-subheader' class='ng-class:{"active":messageOptionsShown}'>
					<li ng-repeat='relationship in user.guru_relationships' ng-if='relationship.guru.name'>
						<a ng-click='setToActiveRelationship(relationship)' ng-if='relationship.id !== active_relationship.id' class='relative'>
							<span class='student-photo-container'>
								<img ng-src="{{relationship.student.profile_url}}" />
								<span class='guru-name'> {{relationship.student.name || 'NA'}} </span>
							</span>
						</a>
					</li>
				</ul>
				<div id='messages' class="scroll">

					<!-- BIND -->
					<div id="message-empty-state" class="full-xy flex-center text-center" ng-if='!active_relationship || !active_relationship.messages || !active_relationship.messages.length'>
						<p>This is the beginning of your conversation thread with <span>this Guru</span>.</p>
					</div>
					<!-- ngRepeat: message in messages -->
					<div ng-repeat="message in active_relationship.messages" class="message-single ng-class:{'left': message.sender.id !== user.id, 'right': user.id === message.sender.id}" on-hold="onMessageHold($event, $index, message)">
						<div class='message-single-icon' ng-if='message.sender.id !== user.id'>
							<img ng-if='user.profile_url' ng-src='{{message.sender.profile_url}}' />
						</div>
						<div class="message-single-content">
							<div class="message-single-info">
								<span ng-if='message.sender.id !== user.id'>{{message.sender.name}}</span>
								<span ng-if='message.sender.id === user.id'>Me</span>
								<span>{{message.time_created}}</span>
							</div>
							<div class="message-single-message">
								{{message.contents}}
							</div>
						</div>
						<div class='message-single-icon' ng-if='message.sender.id === user.id'>
							<img ng-if='user.profile_url' ng-src='{{user.profile_url}}' />
						</div>
					</div>
				</div>

				<!-- <div class="scroll-bar scroll-bar-v">
					<div class="scroll-bar-indicator scroll-bar-fade-out" style="transform: translate3d(0px, 32px, 0px) scaleY(1); height: 988px;"></div>
				</div> -->

				<form name="sendMessageForm" ng-submit="sendMessage(sendMessageForm)" novalidate="" class="ng-valid-minlength ng-valid-maxlength ng-dirty ng-submitted ng-invalid ng-invalid-required">
					<ion-footer-bar class="bar-stable item-input-inset message-footer bar bar-footer" keyboard-attach="">
						<label class="item-input-wrapper">
							<textarea ng-model="active_relationship.new_message" value="" placeholder="Send {{active_relationship.student.name}} a message..." required="" minlength="1" maxlength="1500" msd-elastic="" class="ng-valid-minlength ng-valid-maxlength ng-touched ng-dirty ng-invalid ng-invalid-required"
							style="overflow: hidden; word-wrap: break-word; resize: none; height: 20px;"></textarea>
						</label>
						<div class="footer-btn-wrap">
							<button type="submit" ng-click='sendMessage(active_relationship.new_message)'>
								<svg viewBox="0 0 100 100">
								    <path d="M40.863416,69.0006669 L19,69.0006669 L49.6939787,14 L80.425686,69.0006669 L58.5612746,69.0006669 L49.7317073,85.6527248 L40.863416,69.0006669 Z M49.7317073,15.3170732 L49.7317073,85.5664621 M49.7317073,14.7032382 L58.6,68.0056713 M49.7317073,15.1365913 L40.8634146,68.4390244"></path>
								</svg>
							</button>
						</div>
					</ion-footer-bar>
				</form>

			</section>
			<!-- <div class="tabs tabs-icon-only guru-tabs bg-slate" id='guru-tab-bar-1' ng-if='user && user.id' >
				<a class="tab-item" nav-direction='swap' ui-sref='^.guru'>
					<svg viewBox="0 0 100 100">
						<path d="M87.0865246,40.1315789 L52.7535993,15.621175 C51.9274059,15.0703794 51.0094132,14.7031824 49.9996213,14.7031824 C48.9898294,14.7031824 48.0718367,14.9785802 47.2456434,15.621175 L12.912718,40.1315789 C11.9029261,40.8659731 11.168532,41.9675643 10.9849334,43.1609547 C10.8013349,44.4461444 11.0767327,45.6395349 11.8111268,46.6493268 C12.7291195,47.8427173 14.1061085,48.6689106 15.666696,48.6689106 C16.6764879,48.6689106 17.5944806,48.3935129 18.420674,47.750918 L18.6960718,47.5673195 L49.9996226,25.4712358 L81.3949721,47.5673195 L81.670368,47.750918 C82.4965613,48.3017136 83.414554,48.6689106 84.4243459,48.6689106 C85.9849334,48.6689106 87.3619224,47.9345165 88.2799151,46.6493268 C88.9225099,45.6395349 89.1979077,44.3543452 89.0143092,43.1609547 C88.8307107,41.875765 88.0963166,40.8659731 87.0865246,40.1315789 Z M49.9996213,49.8898409 C53.4298605,49.8898409 56.1875038,47.1321976 56.1875038,43.7019584 C56.1875038,40.2717192 53.4298605,37.5140759 49.9996213,37.5140759 C46.5693821,37.5140759 43.8117388,40.2717192 43.8117388,43.7019584 C43.8117388,47.1321976 46.5693821,49.8898409 49.9996213,49.8898409 Z M60.0520182,83.0018356 L60.0520182,59.9215187 C60.0520182,58.269815 58.7112723,56.9308446 57.0503046,56.9308446 L42.8578934,56.9308446 C41.2000927,56.9308446 39.8561798,58.2776352 39.8561798,59.9215188 L39.8561798,83.001836 M18.6505494,47.8133415 L18.6505494,80.2999257 C18.6505495,83.0596321 20.8838911,85.2968164 23.652709,85.2968165 L41.5085665,85.2968176 L58.4914307,85.2968176 L76.3472905,85.2968165 C79.1099073,85.2968164 81.3494506,83.0643071 81.3494505,80.2999257 L81.3494498,47.8133415"></path>
					</svg>
				</a>
				<a ng-if='!desktopMode' class="tab-item" ng-click='goToStateWithTransition("^.guru-profile", "enter")'>
					<svg viewBox="0 0 100 100">
						<path d="M50.0000186,14 C30.1802821,14 14.030417,30.1419103 14.0000373,49.9835145 C13.9861494,59.7785062 17.8513192,69.2750235 24.6069034,76.038418 C31.0239706,82.4616905 39.5485232,86 48.6120989,86 C49.0955707,86 49.5825143,85.9904558 50.072062,85.969632 C70.2181637,85.1444892 86,69.3383625 86,49.9861175 C86,30.142778 69.8510029,14 50.0000186,14 L50.0000186,14 Z M24.18272,74.5721092 C25.26272,65.2447492 30.77792,57.3967492 38.83328,53.6988292 C35.65568,50.7151492 33.65696,46.4911492 33.65696,41.7986692 C33.65696,32.7871492 40.98848,25.4556292 50,25.4556292 C59.01152,25.4556292 66.34304,32.7871492 66.34304,41.7986692 C66.34304,46.4911492 64.34432,50.7151492 61.16672,53.6988292 C69.22208,57.3967492 74.73728,65.2447492 75.81728,74.5721092"></path>
					</svg>
				</a>
		        <a ng-if='!desktopMode' class="tab-item" ng-click='goToStateWithTransition("^.guru-credibility", "enter")'>
		            <svg viewBox="0 0 100 100">
		                <path d="M50.0004009,87.5 L49.6435674,87.3885396 C49.3284312,87.2907111 41.8541713,84.8882991 34.3526478,75.7726048 C21.9604997,60.7142284 19.3592231,39.2272348 19.3592231,23.8521185 L19.3592231,22.6853931 L20.5259486,22.6493088 C20.7063701,22.6436957 38.7060173,21.9933765 49.2265933,13.1503191 L50.0004009,12.5 L50.7742086,13.1503191 C61.3084165,22.0054046 79.2936299,22.6444975 79.4740514,22.6493088 L80.6407769,22.6845912 L80.6407769,23.8521185 C80.6407769,39.2264329 78.0395003,60.7142284 65.6481541,75.7726048 C58.1466305,84.8882991 50.6723707,87.291513 50.3572345,87.3893415 L50.0004009,87.5 L50.0004009,87.5 Z M50,57.5 L41.1832212,62.1352549 L42.8670761,52.3176275 L35.7341523,45.3647451 L45.5916106,43.9323725 L50,35 L54.4083894,43.9323725 L64.2658477,45.3647451 L57.1329239,52.3176275 L58.8167788,62.1352549 L50,57.5 Z"></path>
		            </svg>
		        </a>
		        <a ng-if='!desktopMode' class="tab-item active" ng-click='goToStateWithTransition("^.guru-messages-mobile", "enter")'>
		        	<svg viewBox="0 0 100 100"  ng-include="img_base + BASE + 'templates/svg.icon.notification.html'">
					</svg>
				</a>

				<a ng-if='!desktopMode' class="tab-item" ng-click='toggleRightSideMenu()' id='settings-button'>
					<svg viewBox="0 0 100 100">
						<path d="M77.7071855,34.003249 C72.1666671,24.4442603 61.8219498,18.0006703 50,18.0000001 L50,8 L50,18 L49.9981554,18 C38.1779324,18 27.8332606,24.4437373 22.2927152,34.0031916 L22.2927152,34.0031916 L13.626933,29 L22.2927152,34.0031916 C19.5635175,38.7120495 17.9999998,44.1769094 17.9999998,50 C17.9999998,55.8230906 19.5635175,61.2879505 22.2927152,65.9968084 L13.626933,71 L22.2927152,65.9968084 C27.8332606,75.5562627 38.1779324,82 49.9981554,82 L50,92 L50,82 C61.8219498,81.9993298 72.1666671,75.5557397 77.7071855,65.996751 L86.373067,71 L77.7071855,65.996751 C80.4364952,61.2879061 82.0000002,55.823067 82.0000002,50 C82.0000002,44.176933 80.4364952,38.7120939 77.7071855,34.003249 L86.373067,29 L77.7071855,34.003249 Z M49.9989624,68 C40.0749409,68 31.9999999,59.925059 31.9999999,50 C31.9999999,40.074941 40.0749409,32 49.9989624,32 C59.9250591,32 68.0000001,40.074941 68.0000001,50 C68.0000001,59.925059 59.9250591,68 49.9989624,68 L49.9989624,68 L49.9989624,68 Z"></path>
					</svg>
				</a>
			</div> -->
		</main>
	</ion-modal-view>
</div>