angular.module('uguru.shared.services')
.factory('CategoryService', ['Restangular', function(Restangular) {
    var Category;
    var categories;
    CategoryService = {
        categories:[],
        get: function() {
            return Restangular
                .one('categories').get();
        },
        getAcademic: function() {
            if (Category.categories && Category.categories.length) {
                copied_categories = Category.categories.slice();
                for (var i = 0; i < copied_categories.length; i ++) {
                    var indexCategory = copied_categories[i]
                    if (indexCategory.hex_color === 'academic') {
                        return indexCategory;
                    }
                }
            }
        },
        getLocalCategories: function() {
            return [{"name":"academic","background_url":"./img/categories/bg/academic.jpg","description":"Share your wisdom by tutoring courses you've mastered","hex_color":"#e6389b", "bg_hex_color":"academic","icon_url":"./img/categories/icon/academic.svg","id":5,"is_active":true,"is_approved":true,"num_gurus":103,"num_subcategories":4,"subcategories":[{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Share your wisdom by tutoring courses you've mastered","icon_url":"templates/svg/subcategories/academic/tutoring.svg","id":26,"is_active":true,"is_approved":true,"name":"In Person","num_gurus":45,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Share your wisdom by tutoring courses you've mastered","icon_url":"templates/svg/subcategories/academic/video-outline.svg","id":27,"is_active":true,"is_approved":true,"name":"Remote (Video Chat)","num_gurus":99,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Share your wisdom by tutoring courses you've mastered","icon_url":"templates/svg/subcategories/academic/answerquestions.svg","id":28,"is_active":true,"is_approved":true,"name":"Q&A","num_gurus":96,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Share your wisdom by tutoring courses you've mastered","icon_url":"templates/svg/subcategories/academic/tutorpeers.svg","id":29,"is_active":true,"is_approved":true,"name":"Office Hours","num_gurus":38,"unit_name":"hour"}]},{"name":"baking","background_url":"./img/categories/bg/baking.jpg","description":"Treat your fellow peers with homemade recipes cooked with love","hex_color":"#F6C64E", "bg_hex_color":"baking","icon_url":"./img/categories/icon/baking-small.svg","id":2,"is_active":true,"is_approved":true,"num_gurus":60,"num_subcategories":7,"subcategories":[{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Treat your fellow peers with homemade recipes cooked with love","icon_url":"templates/svg/subcategories/baking/cake.svg","id":8,"is_active":true,"is_approved":true,"name":"Cake","num_gurus":33,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Treat your fellow peers with homemade recipes cooked with love","icon_url":"templates/svg/subcategories/baking/cupcake.svg","id":9,"is_active":true,"is_approved":true,"name":"Cupcakes","num_gurus":52,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Treat your fellow peers with homemade recipes cooked with love","icon_url":"templates/svg/subcategories/baking/donut.svg","id":10,"is_active":true,"is_approved":true,"name":"Donuts","num_gurus":45,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Treat your fellow peers with homemade recipes cooked with love","icon_url":"templates/svg/subcategories/baking/coffee.svg","id":11,"is_active":true,"is_approved":true,"name":"Coffee","num_gurus":24,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Treat your fellow peers with homemade recipes cooked with love","icon_url":"templates/svg/subcategories/baking/flan.svg","id":12,"is_active":true,"is_approved":true,"name":"Flan","num_gurus":19,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Treat your fellow peers with homemade recipes cooked with love","icon_url":"templates/svg/subcategories/baking/cookie.svg","id":13,"is_active":true,"is_approved":true,"name":"Cookies","num_gurus":20,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Treat your fellow peers with homemade recipes cooked with love","icon_url":"templates/svg/subcategories/baking/brownie.svg","id":14,"is_active":true,"is_approved":true,"name":"Brownies","num_gurus":14,"unit_name":"hour"}]},{"name":"household","background_url":"./img/categories/bg/sports.jpg","description":"College students can be lazy. Earn by doing simple household chores.","hex_color":"#7872e3", "bg_hex_color":"household","icon_url":"./img/categories/icon/sports-small.svg","id":7,"is_active":true,"is_approved":true,"num_gurus":29,"num_subcategories":5,"subcategories":[{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"College students can be lazy. Earn by doing simple household chores.","icon_url":"templates/svg/subcategories/household/laundry.svg","id":39,"is_active":true,"is_approved":true,"name":"Laundry","num_gurus":22,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"College students can be lazy. Earn by doing simple household chores.","icon_url":"templates/svg/subcategories/household/vacuum.svg","id":40,"is_active":true,"is_approved":true,"name":"Vacuuming","num_gurus":22,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"College students can be lazy. Earn by doing simple household chores.","icon_url":"templates/svg/subcategories/household/house_cleaning.svg","id":41,"is_active":true,"is_approved":true,"name":"House Cleaning","num_gurus":22,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"College students can be lazy. Earn by doing simple household chores.","icon_url":"templates/svg/subcategories/household/dishes.svg","id":42,"is_active":true,"is_approved":true,"name":"Dishes","num_gurus":18,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"College students can be lazy. Earn by doing simple household chores.","icon_url":"templates/svg/subcategories/household/furniture.svg","id":43,"is_active":true,"is_approved":true,"name":"Build Ikea Furniture","num_gurus":18,"unit_name":"hour"}]},{"name":"photography","background_url":"./img/categories/bg/photography.jpg","description":"Help your peers look great @ a college-friendly price (Not $100+/hr).","hex_color":"#81B566", "bg_hex_color":"photography","icon_url":"./img/categories/icon/photography-small.svg","id":8,"is_active":true,"is_approved":true,"num_gurus":19,"num_subcategories":4,"subcategories":[{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Help your peers look great @ a college-friendly price (Not $100+/hr).","icon_url":"templates/svg/subcategories/photography/graduate.svg","id":44,"is_active":true,"is_approved":true,"name":"Graduation Photos","num_gurus":16,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Help your peers look great @ a college-friendly price (Not $100+/hr).","icon_url":"templates/svg/subcategories/photography/headshots.svg","id":45,"is_active":true,"is_approved":true,"name":"Professional Headshots","num_gurus":17,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Help your peers look great @ a college-friendly price (Not $100+/hr).","icon_url":"templates/svg/subcategories/photography/athlete.svg","id":46,"is_active":true,"is_approved":true,"name":"Athletic & Action Images","num_gurus":15,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Help your peers look great @ a college-friendly price (Not $100+/hr).","icon_url":"templates/svg/subcategories/photography/outdoor.svg","id":47,"is_active":true,"is_approved":true,"name":"Outdoor & Scenery","num_gurus":17,"unit_name":"hour"}]},{"name":"tech","background_url":"./img/categories/bg/delivery.jpg","description":"Save the day for peers who don't live & breath tech (yet...).","hex_color":"#55A4B7", "bg_hex_color":"tech","icon_url":"./img/categories/icon/delivery-small.svg","id":4,"is_active":true,"is_approved":true,"num_gurus":20,"num_subcategories":5,"subcategories":[{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Save the day for peers who don't live & breath tech (yet...).","icon_url":"templates/svg/subcategories/tech/wifi.svg","id":21,"is_active":true,"is_approved":true,"name":"Wifi setup","num_gurus":18,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Save the day for peers who don't live & breath tech (yet...).","icon_url":"templates/svg/subcategories/tech/phonerepair.svg","id":22,"is_active":true,"is_approved":true,"name":"Phone Screen Repair","num_gurus":18,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Save the day for peers who don't live & breath tech (yet...).","icon_url":"templates/svg/subcategories/tech/computerrepair.svg","id":23,"is_active":true,"is_approved":true,"name":"Computer Repair","num_gurus":18,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Save the day for peers who don't live & breath tech (yet...).","icon_url":"templates/svg/subcategories/tech/virusremoval.svg","id":24,"is_active":true,"is_approved":true,"name":"Virus Removal","num_gurus":16,"unit_name":"hour"},{"avg_hourly":6,"avg_hourly_higher":8,"avg_hourly_lower":0,"description":"Save the day for peers who don't live & breath tech (yet...).","icon_url":"templates/svg/subcategories/tech/cd.svg","id":25,"is_active":true,"is_approved":true,"name":"Software Setup","num_gurus":19,"unit_name":"hour"}]}] ;
        },
        mapActiveToSubcategories: function(categories, user) {
            categories_sliced = categories.slice();
            for (var i = 0; i < categories_sliced.length; i ++) {
                var indexCategory = categories_sliced[i];
                indexCategory.active_subcategories = 0;
            }
            if (!user.guru_subcategories || !user.guru_subcategories.length) {
                return;
            }
            for (var i = 0; i < user.guru_subcategories.length; i ++) {
                for (var j = 0; j < categories_sliced.length; j ++) {

                    var userSubcategory = user.guru_subcategories[i];
                    indexCategory = categories_sliced[j];
                    if (!userSubcategory.category || !indexCategory) {
                        continue;
                    }
                    if (indexCategory.id === userSubcategory.category.id) {
                        indexCategory.active_subcategories += 1
                        for (var k = 0; k < indexCategory.subcategories.length; k++) {
                            var indexSubcategory = indexCategory.subcategories[k];

                            if (indexSubcategory.id === userSubcategory.id)
                                categories[j].subcategories[k].active = true;

                        }
                    }
                }
            }
        }
    };
    return CategoryService;
}]);
