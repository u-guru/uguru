<ion-view class="bottom-0 guru-message-container"><main id="desktop-messaging" class="desktop-mode" ng-if="desktopMode"><div class="main absolute bottom-0 full-x"><div id="messenger"><div id="messenger-sidebar"><h1>My Gurus</h1><ul><li ng-repeat="relationship in user.guru_relationships|filter:student_search.search_text:strict" ng-click="setToActiveRelationship(relationship)"><a class='ng-class:{"active":relationship.id === active_relationship.id}'><span class="messenger-icon" style="background-image: url({{relationship.guru.profile_url}})"></span> <span class="messenger-label">{{active_relationship.guru.name}}</span></a></li></ul><div id="messenger-sidebar-search"><label for="messenger-sidebar-search"><svg viewBox="0 0 100 100"><path d="M42.5,71 C58.2401154,71 71,58.2401154 71,42.5 C71,26.7598846 58.2401154,14 42.5,14 C26.7598846,14 14,26.7598846 14,42.5 C14,58.2401154 26.7598846,71 42.5,71 Z M62.994485,62.994485 L85.6624699,85.6624699"></path></svg></label><input name="messenger-sidebar-search" placeholder="Filter" ng-model="student_search.search_text"></div></div><div id="messenger-content"><div class="messenger-header"><h1 class="no-menu"><span class="weight-300">{{active_relationship.nav.menu_titles[active_relationship.nav.menu.active_index]}} with </span>{{active_relationship.guru.name}}</h1><a class="cta-modal-close close-button desktop-header-next"><svg viewBox="0 0 100 100"><path d="M50,50 L50,14 L50,50 L14,50 L50,50 Z M50,50 L50,86 L50,50 L86,50 L50,50 Z"></path></svg></a><div id="message-search" ng-if="false"><input ng-if="false" placeholder="Search anything" placeholder="Filter" ng-model="active_relationship.search_text"> <a><svg viewBox="0 0 100 100"><path d="M42.5,71 C58.2401154,71 71,58.2401154 71,42.5 C71,26.7598846 58.2401154,14 42.5,14 C26.7598846,14 14,26.7598846 14,42.5 C14,58.2401154 26.7598846,71 42.5,71 Z M62.994485,62.994485 L85.6624699,85.6624699"></path></svg></a></div><nav ng-if="true" id="message-nav" class="ng-class:{'active':active_relationship.msg_nav}"><a ng-click="toggleActiveRelationshipMessageNav()"><svg class="ng-class:{'active':active_relationship.msg_nav}" viewBox="0 0 100 100"><path d="M14,23 L86,23"></path><path d="M14,50 L86,50"></path><path d="M14,77 L86,77"></path></svg></a><div class="active"><ul><li><a ng-click="active_relationship.nav.menu.active_index = 0" ng-class="{'bg-charcoal-impt': active_relationship.nav.menu.active_index === 0}"><svg viewBox="0 0 100 100"><path d="M23.2244571,18.0571429 L23.2244571,18.0571429 L78.7755429,18.0571429 C83.3177143,18.0571429 87,21.7445714 87,26.2826286 L87,65.3745143 C87,69.9177143 83.3177143,73.6 78.7755429,73.6 L57.1714286,73.6 L51,85.9428571 L44.8285714,73.6 L23.2244571,73.6 C18.6822857,73.6 15,69.9125714 15,65.3745143 L15,26.2826286 C15,21.7394286 18.6822857,18.0571429 23.2244571,18.0571429 L23.2244571,18.0571429 Z"></path></svg></a></li><li><a ng-click="active_relationship.nav.menu.active_index = 1" ng-class="{'active': active_relationship.nav.menu.active_index === 1}"><svg viewBox="0 0 100 100"><path d="M24.2857143,39.7142857 C24.2085714,25.5128 35.7985143,14 50,14 C64.2014857,14 75.7914286,25.5128 75.7142857,39.7142857 C75.6001143,60.8658286 50,86 50,86 C50,86 24.4009143,60.8658286 24.2857143,39.7142857 Z M50,50 C55.6806431,50 60.2857143,45.3949289 60.2857143,39.7142857 C60.2857143,34.0336426 55.6806431,29.4285714 50,29.4285714 C44.3193569,29.4285714 39.7142857,34.0336426 39.7142857,39.7142857 C39.7142857,45.3949289 44.3193569,50 50,50 Z"></path></svg></a></li><li><a ng-click="active_relationship.nav.menu.active_index = 2" ng-class="{'active': active_relationship.nav.menu.active_index === 2}"><svg viewBox="0 0 100 100"><path d="M42.5,71 C58.2401154,71 71,58.2401154 71,42.5 C71,26.7598846 58.2401154,14 42.5,14 C26.7598846,14 14,26.7598846 14,42.5 C14,58.2401154 26.7598846,71 42.5,71 Z M62.994485,62.994485 L85.6624699,85.6624699"></path></svg></a></li><li><a ng-click="active_relationship.nav.menu.active_index = 3" ng-class="{'active': active_relationship.nav.menu.active_index === 3}"><svg viewBox="0 0 100 100"><path d="M15,26.9943126 C15,22.5791757 18.579658,19 22.9957852,19 L77.0042148,19 C81.420165,19 85,22.57869 85,26.9943126 L85,73.0056874 C85,77.4208243 81.420342,81 77.0042148,81 L22.9957852,81 C18.579835,81 15,77.42131 15,73.0056874 L15,26.9943126 Z M85,36 L15,36 L85,36 Z M17,66.5 L83,66.5 M17,51.5 L83,51.5 M67.5,37 L67.5,79 M32.5,37 L32.5,79 M50,37 L50,79"></path></svg></a></li><li><a ng-click="active_relationship.nav.menu.active_index = 4" ng-class="{'active': active_relationship.nav.menu.active_index === 4}"><svg viewBox="0 0 100 100"><path d="M26.5585171,14 C23.7977205,14 21.5596527,16.2337694 21.5596527,19.0057363 L21.5596527,80.9942637 C21.5596527,83.7588555 23.7894161,86 26.5575218,86 L73.4417836,86 C76.2020305,86 78.4396823,83.7643283 78.4397188,81.0001225 L78.4403462,33.5605722 C78.4403609,32.4548035 77.7876011,30.9334881 77.0011727,30.1806226 L61.5384132,15.3777783 C60.7435649,14.6168523 59.2032934,14 58.1083137,14 L26.5585171,14 Z M60.0992131,14.96 C60.0992131,14.96 60.0992131,15.4039671 60.0992131,15.9609247 L60.0992131,26.5558242 C60.0992131,29.318671 62.3364841,31.5584009 65.1045233,31.5584009 L77.4848101,31.5584009"></path></svg></a></li><li><a ng-click="active_relationship.nav.menu.active_index = 5" ng-class="{'active': active_relationship.nav.menu.active_index === 5}"><svg viewBox="0 0 100 100"><path d="M50,86 C69.882251,86 86,69.882251 86,50 C86,30.117749 69.882251,14 50,14 C30.117749,14 14,30.117749 14,50 C14,69.882251 30.117749,86 50,86 Z M50,40 L50,70 M50,30 L50,31"></path></svg></a></li><li><a ng-click="active_relationship.nav.menu.active_index = 6" ng-class="{'active': active_relationship.nav.menu.active_index === 6}"><svg viewBox="0 0 100 100"><path d="M50,86 C69.882251,86 86,69.882251 86,50 C86,30.117749 69.882251,14 50,14 C30.117749,14 14,30.117749 14,50 C14,69.882251 30.117749,86 50,86 Z M62,41 C62,32 52.9423828,30.5131836 50,30.5131836 C47.0576172,30.5131836 38,32 38,41 C38,46.4300003 42.675293,49.1364937 50,50.2399998 C57.324707,51.3435059 62,53.8100014 62,59.2399998 C62,68.2399998 52.9423828,69.7268162 50,69.7268162 C47.0576172,69.7268162 38,68.2399998 38,59.2399998 M50,23.4736842 L50,76.5263158"></path></svg></a></li></ul></div></nav></div><div id="message-container" class="relative"><div id="messages" style="padding:0"><div class="messages-main absolute full-xy p15xy" ng-if="active_relationship.nav.menu.active_index === 0"><div class="message-single message-status left center"><div class="message-single-icon" ng-include="img_base + 'templates/green-guru-svg.html'"></div><div class="message-single-content"><div class="message-single-info"></div><div class="message-single-status">This is the beginning of your message thread with <strong>{{active_relationship.guru.name}}</strong></div></div></div><div ng-repeat="message in active_relationship.messages|filter:active_relationship.search_text:strict" class="message-single ng-class:{'left': message.sender.id !== user.id, 'right': user.id === message.sender.id}"><div class="message-single-icon" ng-if="message.sender.id !== user.id"><span ng-if="user.profile_url" style="background-image: url({{message.sender.profile_url}})"></div><div class="message-single-content"><div class="message-single-info"><span ng-if="message.sender.id !== user.id">{{message.sender.name}}</span> <span ng-if="message.sender.id === user.id">Me</span> <span>{{message.time_created}}</span></div><div class="message-single-message" ng-if="message.contents && message.contents.length">{{message.contents}}</div><div class="message-single-message" ng-if="message._file && message._file.id"><div class="weight-700">1 file attached</div><a href="{{message._file.url}}">{{message._file.name}}, {{message._file.size/1000}}kb</a></div></div><div class="message-single-icon" ng-if="message.sender.id === user.id"><span ng-if="user.profile_url" style="background-image: url({{user.profile_url}})"></div></div><div id="message-dropzone" class="bg-slate-50p absolute left-0 full-x txt-charcoal weight-400" style="bottom:64px; height:150px" ng-class="{'show':showAttachments}">Drag attachments here</div><div id="message-box" class="bottom-0 left-0 absolute"><a ng-click="showAttachments = !showAttachments"><svg viewBox="0 0 100 100"><path d="M23.9602215,14 C18.4593164,14 14,18.4585633 14,23.9588015 L14,76.0411985 C14,81.5417132 18.4592951,86 23.9602215,86 L76.0397785,86 C81.5406836,86 86,81.5414367 86,76.0411985 L86,23.9588015 C86,18.4582868 81.5407049,14 76.0397785,14 L23.9602215,14 L23.9602215,14 Z M68,50 C68,40.0588745 59.9411255,32 50,32 C40.0588745,32 32,40.0588745 32,50 C32,59.9411255 40.0588745,68 50,68 C59.9411255,68 68,59.9411255 68,50 Z"></path></svg> </a><input placeholder="Message" ng-model="active_relationship.new_message"> <button ng-click="sendMessage(active_relationship.new_message)" class="message-send-button"><svg viewBox="0 0 100 100"><path d="M40.863416,69.0006669 L19,69.0006669 L49.6939787,14 L80.425686,69.0006669 L58.5612746,69.0006669 L49.7317073,85.6527248 L40.863416,69.0006669 Z M49.7317073,15.3170732 L49.7317073,85.5664621 M49.7317073,14.7032382 L58.6,68.0056713 M49.7317073,15.1365913 L40.8634146,68.4390244"></path></svg></button></div></div><!-- Location --><div id="messages-main" class="messages-main absolute full-xy p15xy" ng-if="active_relationship.nav.menu.active_index === 1"></div><!-- Create a request --><div id="messages-request" class="messages-main absolute full-xy p15xy" ng-if="active_relationship.nav.menu.active_index === 2" ng-controller="RequestController" ng-include="img_base + BASE + 'templates/request.html'"></div><!-- Create a calendar --><div id="messages-calendar" class="messages-main absolute full-xy p15xy" ng-if="active_relationship.nav.menu.active_index === 3"></div><!-- Create a calendar --><div id="messages-files" class="messages-main absolute full-xy p15xy" ng-if="active_relationship.nav.menu.active_index === 4"></div><!-- Session History --><div id="messages-history" class="messages-main absolute full-xy p15xy" ng-if="active_relationship.nav.menu.active_index === 5"></div><!-- Session Payments --><div id="messages-payments" class="messages-main absolute full-xy p15xy" ng-if="active_relationship.nav.menu.active_index === 6"></div><!-- Session Options --><div id="messages-preferences" class="messages-main absolute full-xy p15xy" ng-if="active_relationship.nav.menu.active_index === 7"></div></div></div></div></div></div></main></ion-view>