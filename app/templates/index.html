{% extends 'base.html' %}
{% block header %}
  <link href="/static/css/jquery.nouislider.min.css" rel="stylesheet">
  <link href="/static/css/bootstrap-formhelpers.min.css" rel="stylesheet">
{% endblock %}

{% block content %}

  <!-- Jinja2 Variable Definitions -->
  {% set request_form = forms[0] %}

 	<!-- Full Page Image Header Area -->
    <div id="top" class="header">
      <div class="vert-text">
        <div class="main-area" style="display:block">
        	<img class="img-portfolio img-responsive" src="/static/img/guru.jpg">
          <h1>uGuru.me</h1>
          <h3><em>Peer to Peer</em> private tutoring.<br>Affordable. Quick.</h3>
          <a href="#" id="student-signup-btn" class="btn btn-default btn-lg">Need a Tutor?</a>
          <a href="/tutorsignup1" class="btn btn-lg btn-primary">Become a Tutor</a>      
                <h4>or <a href="#" id="login-link" >LogIn</a> </h4>
              <h3>See <a href="/howitworks/">How it Works</a>.</h3>
        </div>

        <div class="login-modal" style="display:none">            
            <div class="row vertical-offset-100">
              <div class="col-md-4 col-md-offset-4">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <button type="button" class="close" id="modal-close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h2>Log In</h2>
                  </div>
                  <div class="panel-body">
                    <form accept-charset="UTF-8" role="form">
                    <fieldset>
                      <div class="form-group">
                          <input class="form-control" placeholder="E-mail" name="email" type="text">
                      </div>
                      <div class="form-group">
                        <input class="form-control" placeholder="Password" name="password" type="password" value="">
                      </div>
                       <a href="/" class="btn btn-lg btn-success btn-block" type="submit">Submit</a>
                    </fieldset>
                    </form>
                  </div>
                </div>
            </div>
          </div>
        </div>

        <div class="student-signup-modal" style="display:none">            
            <div class="row vertical-offset-100">
              <div class="col-md-4 col-md-offset-4">
                
                <!-- Panel 1 -->
                <div id="student-panel-1" class="panel panel-default">                  
                  <div class="panel-heading">
                    <button type="button" class="close" id="modal-close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h3>What do you need help in?</h3>                    
                  </div>

                  <!-- Panel Body -->
                  <div class="panel-body">
                    <form method='post' action ='/'>
                      {{ request_form.hidden_tag()}}                      
                      <div class="form-group" id='skill-form-group'>
                        <input name="skill" class="form-control" id="student-signup-skill" type="text" class="search-query form-control" placeholder="Add Skill/Course (i.e. CS10 or Essay Proofreading)"/>
                      </div>
                      
                      <h4>Please Tell Us More</h4>
                      <textarea class="form-control" id="student-signup-description" name="description" rows="3" placeholder="Example: My CS61A project is due in 2 weeks. Topics that I need help in are... You can best prepare by..."></textarea>
                      
                      <h4>Urgency</h4>                     
                      <div class="btn-group" data-toggle="buttons">
                         {% for subfield in request_form.urgency %}
                        <label class="btn btn-default">
                          {{ subfield }} {{subfield.label.text}}
                        </label>
                        {% endfor %}
                      </div>                                             
                      
                      <h4>Frequency</h4>
                      <div class="btn-group" data-toggle="buttons">
                         {% for subfield in request_form.frequency %}
                        <label class="btn btn-default">
                          {{ subfield }} {{subfield.label.text}}
                        </label>
                        {% endfor %}
                      </div>                                             
                      <!-- Slider -->
                      <h4>Time Estimate (per session)</h4>
                          <div class="noUiSlider"></div>
                          <p class="text-right"><span id="low"></span> hours </p>
                      <div>
                        <span id='alert-fields-student-signup1' style="color:red;display:None">Please fill or select all fields</span>
                        <a href="javascript:void(0)" id="student-signup-next" class="btn btn-lg btn-success btn-block" type="submit">Next</a>
                      </div>

                    </form>
                  </div>
                  <!-- /Panel Body -->
                </div>
                <!-- /Panel 1 -->

                <!-- Panel 2 -->
                <div  id="student-panel-2" class="panel panel-default" style="display:None">
                  <div class="panel-heading">
                  <h2>Signup Information</h2>
                  </div>
                  <!-- Panel Body 2-->
                  <div class="panel-body">
                    <h4>So we can let you know when we've found a tutor for you!</h4>
                    <form accept-charset="UTF-8" role="form">
                      <fieldset>
                        <div class="form-group">
                          <input class="form-control" placeholder="Name" id="student-signup-name" name="name" type="text">
                        </div>
                        <div class="input-group" style="padding-bottom:15px;">
                            <input class="form-control" placeholder="E-mail" id="student-signup-email" name="email" type="text">
                            <span class="input-group-addon">@berkeley.edu</span>           
                        </div>

                        <div class="form-group">
                          <input class="form-control" id="student-signup-password" placeholder="Password" name="password" type="password" value="">
                        </div>
                        <div class="form-group">
                            <input class="form-control bfh-phone" id="student-signup-phone" data-format="+1 (ddd) ddd-dddd" placeholder="Phone Number" name="phone" type="text">
                        </div>
                          <p>Your phone number will never be provided to anyone. We only use it to notify you to make things quicker on both ends.
                          </p>
                          <span id='alert-fields-student-signup2' style="color:red;display:None">Please fill or select all fields</span>

                        <a id="student-signup-submit" href="javascript:void(0);" class="btn btn-lg btn-success btn-block" type="submit">Submit</a>
                        <p>By clicking submit you agree to our <a href="/TermsofService/">Terms of Service</a> and <a href="PrivacyPolicy">Privacy Policy</a>.</p>
                      </fieldset>
                    </form>
                  </div>
                  <!-- /Panel Body 2-->

                </div>
              </div>
            </div>
        </div>
      </div>
      
    </div>
  <!-- /Full Page Image Header Area -->

{% endblock %}

{% block footer_scripts %}
<script src="/static/js/jquery.nouislider.min.js"></script>
<script src="/static/js/bootstrap-formhelpers.min.js"></script>

<!-- Show/Hide Login Jquery -->
<script type="text/javascript">
  // Open Login Dialog
  $('#login-link').click(function(){
    $('.main-area').hide('slow'); 
    $('.login-modal').show('slow');
  });

  //Close modal dialog by pressing corner x button
  $('#modal-close').click(function(){
    $('.login-modal').hide('slow');
    $('.student-signup-modal').hide('slow')
    $('.main-area').show('slow');       
  });

  //Close login dialog by pressing escape
  $(document).keyup(function(e) {
    if (e.keyCode == 27) { 
      $('.login-modal').hide('slow');
      $('.student-signup-modal').hide('slow');
      $('.main-area').show('slow');        
    }
  });
</script>

<!--Student signup show/hide Jquery -->
<script type="text/javascript">
  // Open Student Signup Dialog
  $('#student-signup-btn').click(function(){
    $('.main-area').hide('slow'); 
    $('.student-signup-modal').show('slow');
    // $('#student-signup-skill').focus();
    // window.scrollTo(0, 0);
  });

</script>

<script>$(".noUiSlider").noUiSlider({
  range: [0.5, 10]
  ,start: 2
  ,step: 0.5
  ,handles: 1
  ,serialization: {
    to: [ $("#low"), 'html' ],
    resolution: 0.1
  }
});</script>

<script type=text/javascript>
  $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
</script>

<!--JavaScript form validation for student-signup-->
<script>
  //Validation for part 1
  $('#student-signup-next').click(function(){
    if ((!$('#student-signup-description').val() || !$('#student-signup-skill').val()) || $('input[type=radio]:checked').size() < 2) {
      $('#alert-fields-student-signup1').show()
    } else {
       $('#student-panel-1').hide('slow'); 
       $('#student-panel-2').show('slow');
    }
  });
  $('#student-signup-skill').blur(function(){
    if ($('#student-signup-skill').val()) {
      $('#student-signup-skill').css({"border-color":"#3c763d"
      })
    } else {
      $('#student-signup-skill').css({"border-color":"#a94442"
      });
    }
  });
  $('#student-signup-description').blur(function(){
    if ($('#student-signup-description').val()) {
      $('#student-signup-description').css({"border-color":"#3c763d"
      })
    } else {
      $('#student-signup-description').css({"border-color":"#a94442"
      });
    }
  });

  //Validation for part 2
  $('#student-signup-submit').click(function(){
    if ((!$('#student-signup-name').val() || !$('#student-signup-email').val()) 
      || !$('#student-signup-password').val() || !($('#student-signup-phone').val().length == 17)) 
    {
        $('#alert-fields-student-signup2').show()
    } 
    else {
      $('#alert-fields-student-signup2').hide();      
      var data = {
        'name': $('input[name="name"]').val(),
        'email': $('input[name="email"]').val(),
        'phone': $('input[name="phone"]').val(),
      }
      data = 
      $.ajax({
        type: "POST",
        contentType: 'application/json;charset=UTF-8',
        url: '/success/' ,
        data: JSON.stringify(data),
        dataType: "json",        
        success: function(result) {
          alert(result.name);
        }
      });
      // $.getJSON($SCRIPT_ROOT + '/success/', {
      //   email: $('input[name="email"]').val(),
      //   name: $('input[name="name"]').val()
      // }, function(data) {
      //   alert(data.test);
      // });
    }
  });
  $('#student-signup-name').blur(function(){
    if ($('#student-signup-name').val()) {
      $('#student-signup-name').css({"border-color":"#3c763d"
      })
    } else {
      $('#student-signup-name').css({"border-color":"#a94442"
      });
    }
  });
  $('#student-signup-email').blur(function(){
    if ($('#student-signup-email').val()) {
      $('#student-signup-email').css({"border-color":"#3c763d"
      })
      if ($(this).val().indexOf("@berkeley.edu") != -1) {
        var text = $(this).val().replace("@berkeley.edu","");
        $(this).val(text);
      }
    } else {
      $('#student-signup-email').css({"border-color":"#a94442"
      });
    }
  });
  $('#student-signup-password').blur(function(){
    if ($('#student-signup-password').val()) {
      $('#student-signup-password').css({"border-color":"#3c763d"
      })
    } else {
      $('#student-signup-password').css({"border-color":"#a94442"
      });
    }
  });
</script>

{% endblock %}