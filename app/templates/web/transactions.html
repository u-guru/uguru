{% extends 'web/base.html' %}
{% set user_transactions = user.get_all_transactions() %}

    {% block main_header %}
    <header class="bar bar-nav">
      <h1 class="title">My Transactions</h1>
      <a class="icon icon-left-nav pull-left" href="/m/settings/" data-transition="slide-out"></a>
    </header>
    {% endblock %}

    {% block main_content %}
    <div class="content should-hide-tab-bar should-hide-message-bar">
        
            <div class='font-16 green-text center margin-top-10 margin-bottom-10'>
              {% if user.credit %}

                <span class='white-text'> Credits: ${{user.credit}}
                </span>
                    
              {% elif user.total_earned %}

                <span class='grey-text font-16'>Total:</span> 
                <strong> 
                  ${{user.total_earned}}
                </strong>
        {% endif %}
          </div>
      <ul class="table-view">
        
        {% for transaction in user_transactions %}

          {% if transaction['type'] == 'student' %}
            
            <li class="table-view-cell message-cell media">
              <img class="media-object pull-left message-face" src="{{transaction['guru']['profile_url']}}">
              <div class="media-body">
                  {{transaction['guru']['name']}} helped you in CS10
              </div>
              <span class='pull-right negative-text bold'> -${{transaction['amount']|round}} </span>
              <p>
                {{transaction['time']}}
              </p>
            </li>

          {% endif %}

          {% if transaction['type'] == 'guru' %}
            
            <li class="table-view-cell message-cell media">
              <img class="media-object pull-left message-face" src="{{transaction['student']['profile_url']}}">
              <div class="media-body">
                  You helped {{transaction['student']['name']}} in CS10
              </div>
              <span class='pull-right green-text bold'> 
                {% set amount = transaction['amount']|int %}
                {% if amount %}
                  +${{transaction['amount']|int}} 
                {% else %}
                  Free
                {% endif %}
                </span>
              <p>
                {{transaction['time']}}
              </p>
            </li>

          {% endif %}
          {% if transaction['type'] == 'cashout' %}
            
            <li class="table-view-cell message-cell media">
              <img class="media-object pull-left message-face" src="{{user.as_dict()['profile_url']}}">
              <div class="media-body">
                  You cashed out
              </div>
              <span class='pull-right green-text bold'> +${{transaction['amount']|int}} </span>
              <p>
                {{transaction['time']}}
              </p>
            </li>

          {% endif %}
        {% endfor %}

      </ul>
      
    </div>
  
  {% endblock %}

    
