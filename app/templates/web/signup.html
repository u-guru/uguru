{% extends 'web/base.html' %}

{% block main_header %}
<header id='header-bar' class="bar bar-nav no-border-bottom login-header">
  <a class="icon icon-left pull-left" href='/m/welcome/' data-transition='slide-out'></a>
  <h1 class="title">Sign Up</h1>
</header>
{% endblock %}

{% block main_content %}

<div class="content should-hide-message-bar should-hide-tab-bar">
    <form class="input-group" id="signup-form">
        <div class='input-row'>
            <label>First</label>
            <input type="text" id="name-field" placeholder="First name"></input>
        </div>
        <div class='input-row'>
            <label>Last</label>
            <input type="email" id="name-field-last" placeholder="Last name"></input>
        </div>
        <div class='input-row'>
            <label>Email</label>
            <input type="email" id="email-field" placeholder="Your School Email"></input>
        </div>
        <div class='input-row'>
            <label>Password</label>
            <input type="password" id="password-field" placeholder="Password"></input>
        </div>
    </form>
    <a class="btn btn-positive btn-block" data-transition='slide-in' href="#" id="signup-link">Sign Up</a>
    <script>
    $(document).ready(function() {
        $('#signup-link').click(function(){
            name = $('#signup-form #name-field').val() + ' ' +$('#signup-form #name-field-last')

            payload = JSON.stringify({
                name     : name,
                email    : $('#signup-form #email-field').val(),
                password : $('#signup-form #password-field').val()
            });

            $.ajax({
                url: '/api/v1/signup',
                type: 'POST',
                contentType: 'application/json',
                data: payload,
                success: function(request){
                    window.PUSH({
                        transition : "slide-in",
                        url : "/m/home/"
                    });
                },
                error: function (request) {
                    alert(request.responseJSON['errors']);
                }
            });
        });
    });
</script>
</div>

{% endblock %}
