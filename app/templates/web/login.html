{% extends 'web/base.html' %}

{% block main_header %}
<header id='header-bar' class="bar bar-nav no-border-bottom login-header">
  <a class="icon icon-left pull-left" href='/m/welcome/' data-transition='slide-out'></a>
    <h1 class="title">Login</h1>
</header>
{% endblock %}

{% block main_content %}

<div class="content should-hide-message-bar should-hide-tab-bar">
    <form class="input-group" id="login-form" >
      <div class='input-row'>
          <label>EMAIL</label>
          <input href='#login-modal' type="email" id="email-field" placeholder="your email"></input>
      </div>
      <div class='input-row'>
          <label>PASSWORD</label>
          <input href='#signup-modal' type="password" id="password-field" placeholder="Password"></input>
      </div>
  </form>
  <a class="btn btn-positive btn-block" data-transition='slide-in' href="#" id="login-link">Login</a>
</div>

<script>
    $(document).ready(function() {
        $('#login-link').click(function(event) {
            payload = JSON.stringify({
                email:$('#login-form #email-field').val(),
                password:$('#login-form #password-field').val()
            });
            $.ajax({
                url: '/api/v1/login',
                type: 'POST',
                contentType: 'application/json',
                data: payload,
                success: function(request){
                    window.PUSH({
                        transition : "slide-in",
                        url : "/home/"
                    });
                },
                error: function (request) {
                    alert(request.responseJSON['errors']);
                }
            });
        });
    });
</script>
{% endblock %}