{% import '/macros/notifications.html' as notification_template %}
{% from '/macros/confirm-payment-form.html' import confirm_payment_form %}
{% from '/macros/notifications.html' import notification_details_template %}
{% extends 'base.html' %}

{% block header %}
<link href="/static/css/jquery.nouislider.min.css" rel="stylesheet">
<link href="/static/css/inserthtml.com.radios.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
{% include 'calendar.html' %}
{% if (user.approved_by_admin and user.verified_tutor and (not user.skills or not user.tutor_introduction or not user.major or not user.phone_number or not user.year or (user.profile_url == '/static/img/default-photo.jpg'))) %}
		{% set guru_profile_not_complete = true %}
{% else %}	
		{% set guru_profile_not_complete = false %}
{% endif %}
{% if confirm_payments|length > 0 %}
	
	{{confirm_payment_form(confirm_payments[0], user)}}

{% elif user.pending_ratings|length > 0 %}
	<div id="rating-form-tutor">
		<div class="page-title">
		  <div class="row-fluid" style="width:100%;text-align:center">
		      <div class="col-xs-12 col-md-12 col-sm-12" style="text-align:center">
		        <h4 style="color:white;width:100%;font-weight:500">PLEASE RATE YOUR EXPERIENCE WITH
		        	{% if pending_ratings_dict['tutor'].id == user.id %}
		        	<span id="student-name">{{pending_ratings_dict['student'].name.split(" ")[0]|upper}}</span>
		        	{% else %}
		        	<span id="student-name">{{pending_ratings_dict['tutor'].name.split(" ")[0]|upper}}</span>
		        	{% endif %}
		        </h4>
		    </div>
		  </div>
		</div>
		<div class="container-fluid">
			<br>
			<div id="rate-alert" style="color:red;text-align:center;display:none"class="row">
				Please select the number of stars and fill in all fields
			</div>
			<div style="text-align:center;"class="row">
				<h4 style="color:grey;">Reviews help tutors and students find the right match.</h4>
				<h6 style="color:grey">Don't worry! Your ratings and review will remain anonymous.</h6>
			</div>
			<div class="row">
			  	<div class="user-profile" style="text-align:center">
			  		{% if pending_ratings_dict['tutor'].id == user.id %}
	  					<img id="student-profile-photo" style="height:120px;width:120px"  src="{{pending_ratings_dict['student'].profile_url}}" class="user-photo">
			  		{% else %}
		  				<img id="student-profile-photo" style="height:120px;width:120px"  src="{{pending_ratings_dict['tutor'].profile_url}}" class="user-photo">
			  		{% endif %}
			  	</div>
			</div>
			<div style="text-align:center; color:grey;margin-top:-5px"class="row">
				{% if pending_ratings_dict['tutor'].id == user.id %}
	        	<span id="student-name">{{pending_ratings_dict['student'].name.split(" ")[0]|upper}}</span>
	        	{% else %}
	        	<span id="student-name">{{pending_ratings_dict['tutor'].name.split(" ")[0]|upper}}</span>
	        	{% endif %}
			</div>
			<div style="text-align:center" class="row">
				<div id="tutor-rating-stars" class="rating">
					<span>☆</span>
					<span>☆</span>
					<span>☆</span>
					<span>☆</span>
					<span>☆</span>
				</div>	
			</div>
			<br>
			<div class="row">
				<div class="col-xs-12 col-sm-offset-3 col-sm-6 col-md-4 col-md-offset-4">
					{% if pending_ratings_dict['tutor'].id == user.id %}
					<textarea name="description" placeholder="How would you describe your experience? "id="student-rating-description" class="form-control" rows="3"></textarea>
					{% else %}
					<textarea name="description" placeholder="How would you describe your experience? How helpful was your Guru?"id="tutor-rating-description" class="form-control" rows="3"></textarea>
					{% endif %}
				</div>
			</div>
			<div id="launch-profile-div" class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-offset-4 col-md-4" style="padding-left:10px; padding-right:10px; margin-top:20px; margin-bottom:0px; display:block">
				{% if pending_ratings_dict['tutor'].id == user.id %}
				<a href="javascript:void(0)" id="submit-student-rating">
				{% else %}
				<a href="javascript:void(0)" id="submit-tutor-rating">
				{% endif %}
					<div class="tutor-submit-next">SUBMIT
					</div>
				</a>
			</div>
		</div>
	</div>
{% endif %}


{% if user.pending_ratings|length > 0 or confirm_payments|length > 0 %}
<div id="activity" style="display:none; font-family: 'Roboto',sans-serif;">
{% else %}
<div id="activity" style="font-family: 'Roboto',sans-serif;">
{% endif %}
	<div id="call-to-action-bar" align:"center">
		{% if guru_profile_not_complete %}

			<div style="margin-top:0px; margin-bottom:15px; text-align:center; float:center"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
				<div style="margin-bottom:0"class="alert alert-danger">
				Your guru profile is not complete! Complete it <a href='/settings/#prof'>here.</a>
				</div>
			</div>
		{% endif %}
		{% if not user.verified_tutor %}
		<div id='activity-container-student' class="row margin-top-40 margin-bottom-20">
			<div class="col-xs-offset-1 col-xs-10 col-sm-offset-2 col-sm-8 col-md-offset-4 col-md-4">
				<div class='row-fluid'>
					<a id="tutor-request-link" href="javascript:void(0)">
						<span id='ace-your-class-student-btn' class='blue-btn blue-btn-full font-20'>
							Get Help And Ace Your Class
						</span>
					</a>
				</div>
				{% if user.credit and not user.verified_tutor and not user.approved_by_admin%}
					<div id='student-credit-conftainer' class='row-fluid center font-20 margin-top-20 dark-grey-text'>
						<h5 id='student-credit'style="color:grey; font-size:22px; margin-bottom:0px; margin-top:0px">Your Credits: 
							<span style="color:#69bf69; font-weight:bold"> ${{'%.02f' % user.credit}} 
							</span>
						</h5>
					</div>
				{% endif %}
				<span id='want-to-be-guru-text' class='font-14 grey-text center block margin-top-20'>
				Save <b class='reg-text'>up to $200</b> with our tutoring credit packages. <a href='javascript:void(0);' class='blue-text' id='see-packages-home'>Click here </a> to see deals.
				</span>
			</div>
		</div>
		{% else %}
		<div id='tutor-activity-container' class="row margin-top-40 margin-bottom-20">
			<div class="col-xs-offset-1 col-xs-10 col-sm-offset-2 col-sm-8 col-md-offset-4 col-md-4">
				<div style="color:grey; text-align:center"class="row">
					<h4 id='hello-tutor-text' style="color:grey;font-weight:700; font-size:2em" >Hello, {{user.name.split(" ")[0]}}</h4>
				</div>
				{% if not user.tutor_ratings %}
		            <span id='mobile-rating-stars'style="font-size:20px;"class="rating relative">

		                <span style='font-size:16px; right:-3px; bottom:1px' class='absolute'>(0) </span>

		                <span style="color;rgb(0, 159, 225)">☆</span><span>☆</span><span>☆</span><span>☆</span><span>☆</span>
		            </span>
		            {% else %}
		              {% for i in range(0, avg_rating|round(method='floor')|int) %}
		                <span class="star-icon-feed full">☆</span>
		              {% endfor %}
		              {% if avg_rating - avg_rating|round != 0 %}
		                <span class="star-icon-feed half">☆</span>
		              {% endif %}
		              {% for i in range(0, 5 - avg_rating|round(method='ceil')|int) %}
		                <span class="star-icon-feed empty">☆</span>
		              {% endfor %}
		              &nbsp;<span style="font-size:12px;color:grey">({{num_ratings}})</span>
		            {% endif %}
				<div style="font-weight:700; font-size:12px; margin-top:10px; color:grey" class="row">
						<h5 style="color:grey; font-size:22px; margin-bottom:0px; margin-top:0px">Your Earnings: 
							<span style="color:#69bf69; font-weight:bold"> ${{'%.4g' % user.balance}} 
								{% if user.pending %}
									(${{'%.4g' % user.pending}} pending<span class='grey-text'>*</span>)
								{% endif %}
							</span>
							{% if user.balance > 0 %}
							<a style="color:rgb(0, 159, 225); font-size:14px;" href="/settings/#billing">&nbsp;<u>Cash Out</u></a>
							{% endif %}
						<h5>
					</div>
					{% if user.total_earned %}
					<div style="margin:0px;margin-bottom:5px;text-align:center; font-size:16px; font-weight:700;" class="row">
						<h5 style="color:grey; margin:0">You have made <span style="color:#69bf69"> <strong>${{user.total_earned}} </strong></span> total with Uguru</h5>
					</div>
					{% endif %}
					<div id='guru-needs-help-text-container' class='row-fluid center margin-top-10'>
						<span id='guru-needs-help-text' style='color:#a8a8a8'class='font-14'>
							Even our gurus need help sometimes, request help <a href='javascript:void(0);' id='tutor-request-link' class='blue-text'>here</a>
						</span>
					</div>
				{% if user.credit and not user.approved_by_admin %}
					<div class='row-fluid center font-20 margin-top-10 dark-grey-text'>
						Your uGuru credits: <span class='green-text'> ${{user.credit}} 
					</div>
				{% endif %}
			</div>
		</div>
		{% endif %}
	</div>
	<div id="feed" class="container-fluid">
		<div class="row container-fluid">
			<div style="display:none"id="bootstrap-success" class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-offset-2 col-md-8">
				<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
				<div class="alert alert-success"></div>
			</div>
		</div>
		{% if user.outgoing_requests|length >= 1 %}
		<!-- <div style="display:block" class="row-fluid">
			<div style="margin-top:0px; margin-bottom:15px; text-align:center; float:center"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
				<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
				<div style="margin-bottom:0"class="alert alert-success">You're all set! Check your email frequently.<br> We'll let you know <i>immediately </i> if a tutor has agreed to help! </div>
			</div>
		 </div> -->
		 {% endif %}
		 {% with messages = get_flashed_messages() %}
		  {% if messages %}
		    {% for message in messages %}
		    <div style="display:block" class="row-fluid">
			    <div style="margin-top:10px; text-align:center; float:center"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
			    	<div id='default-activity-alert' style="margin-bottom:0"class="alert {% if 'Chrome' or 'set' in message %} alert-info {% else %} alert-success {% endif %}">{{ message|safe}}</div>
			    </div>
			</div>
		    {% endfor %}
		  {% endif %}
		{% endwith %}
		{% if not user.verified_tutor %}
		<!-- <div style="text-align:center;margin-top:0px; " class="row">
			<div class="col-xs-12 col-sm-offset-3 col-sm-6 col-md-offset-4 col-md-4">
				<h5 style="color:grey; margin-bottom:5px;"> 
					<strong>Your current secret payment code is 
						<span style='color:red'> '{{user.secret_code}}'
						</span>
					</strong>
				</h5>
				<h6 style="margin-top:0px;color:grey;">
					Give this to a Guru to confirm payment at the end of each session.<br>
					Your code regenerates after each payment.
				</h6>
			</div>
		</div> -->
		{% endif %}

		<div id="main-feed" style='padding-top:20px'>
		{% for n in user.notifications|sort(attribute='time_created')|reverse %}
			{{notification_template.notification(n, user, pretty_dates)}}
		{% endfor %}
		</div>
		<span class='font-14 grey-text center block margin-top-20'>
				New to uGuru? Read more <a target='_blank'class='underline blue-text'href='http://tinyurl.com/uguru-q-a'> here </a> 
		</span>
		{% if user.pending %}
		<span class='font-12 grey-text center block margin-top-30'>
				* Your balance is pending because a student hasn't confirmed the amount yet.
		</span>
		{% endif %}
	</div>
	<br>
	<br>
</div>

{% if user.balance > 0%}
<div id="add-bank-account-info" style="display:none; color:rgb(0, 159, 225);">
	<form role="form" action="javascript:void(0)" method="POST" id="payment-form">
		<div class="page-title">
			<div class="row-fluid" style="width:100%;text-align:center">
					<div class="col-xs-1 col-xs-offset-1 col-md-1">
   					<a href="javascript:void(0)" id="bank-account-back-link" style="text-decoration:none"> 
   						<h4 id="back-button"><span style="color:white" class="glyphicon glyphicon-chevron-left"></span> </h4>
   					</a>
					</div>
					<div class="col-xs-9 col-md-8" style="text-align:center">
						<h4 style="color:white;width:100%">BANK ACCOUNT INFO</h4>
				</div>
			</div>
		</div>
		<div class="credit-main container-fluid">
			<br>
			<div class="row">
			  	<div class="user-profile" style="text-align:center">
			  		{% if user.profile_url %}
			  		<img src="{{user.profile_url}}" class="user-photo">
			  		{% else %}
			  		<img src="/static/img/default-photo.jpg" class="user-photo">
			  		{% endif %}
			  	</div>
			</div>
		  	<div class="row" style="text-align:center">
		  		<div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
			  		<h4>Please enter your debit card information to cash out</h4>
			  		<h5 style="margin:25px auto;color:grey">Our payment system is securely <b>Powered by <a href="stripe.com">Stripe</a></b>, which handles all of the bank deposits. Uguru has no access to your bank information.</h5>
				  	<h6 style="margin:25px auto;color:grey">You will receive the funds in your account within <b>1-3</b> days depending on your bank. We will email you confirmation as soon as the money is successfully transfered.</h6>
				</div>
		  	</div>
		  	<!-- <div class="row">
		  		<div class="col-xs-12 col-xs-offset-3 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
				  		<div id="bank-account-alert" class="row" style="display:none; text-align:center; color:red">
				  			Please fill out all fields
				  		</div>
				  		<div class="form-group">
				  			<label for="credit-card-num">
				  				<span class="glyphicon glyphicon-user" style="color:#00a0cf;"></span>
				  				<span class="h4" style="color:#00a0cf">&nbsp;&nbsp;YOUR FULL LEGAL NAME
				  				</span>
				  			</label>
				  			<br>
				  			<input id="full-legal-name"value="{{user.name}}"style="width:100%" type="text" size="20" data-stripe="number" class="input-signup">
				  		</div>
				  		<div class="form-group">
				  			<label for="credit-card-num">
				  				<span class="glyphicon glyphicon-credit-card" style="color:#00a0cf;"></span>
				  				<span class="h4" style="color:#00a0cf">&nbsp;&nbsp;ACCOUNT NUMBER
				  				</span>
				  			</label>
				  			<br>
				  			<input id="bank-account-num" style="width:100%" type="text" size="20" data-stripe="number" class="input-signup">
				  		</div>
				  		<div class="form-group">
				  			<label for="credit-card-num">
				  				<span class="glyphicon glyphicon-random" style="color:#00a0cf;"></span>
				  				<span class="h4" style="color:#00a0cf">&nbsp;&nbsp;ROUTING NUMBER
				  				</span>
				  			</label>
				  			<br>
				  			<input id="bank-routing-num" style="width:100%" type="text" size="20" data-stripe="number" class="input-signup">
				  		</div>
					 	<span class="payment-errors"></span>
					 	<div style="margin-top:20px; margin-bottom:20px;text-align:center" class="row-fluid">
					  			<img src="/static/img/powered-stripe.png">
					  	</div>
				</div>
			</div> -->
			<div class="row">
			  		<div class="col-xs-10 col-xs-offset-1 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
					  		<br>
					  		<div style="text-align:center">
					  			<span class="debit-payment-errors"></span>
					  		</div>
					  		<div style="display:block" class="form-group">
					  			<label for="credit-card-num">
					  				<span class="glyphicon glyphicon-credit-card" style="color:#00a0cf;"></span>
					  				<span class="h4" style="color:#00a0cf">&nbsp;&nbsp;CARD
					  				</span>
					  			</label>
					  			<br>
					  			<input placeholder="•••• •••• •••• ••••" style="width:100%" type="text" size="20" data-stripe="number" class="input-signup" id="debit-card-num">
					  		</div>
					  		<div style="display:block"class="row-fluid">
					  			<div style="padding-left:0px" class="col-xs-6 col-sm-6 col-md-6">
							  		<div style="display:inline"class="form-group">
							  			<label for="expiration-date">
							  				<span class="glyphicon glyphicon-calendar" style="color:#00a0cf"></span>
							  				<span class="h4" style="color:#00a0cf">&nbsp;&nbsp;EXPIRATION DATE</span>
							  			</label>
							  			<br>
							  			<input placeholder="MM/YY" style="width:100%" class="input-signup" type="text" data-stripe="exp-month" id="debit-expiration-date">
							  		</div>
							  	</div>
							  	<div style="padding-right:0px" class="col-xs-6 col-sm-6 col-md-6">
							  		<div style="display:inline"class="form-group">
							  			<label for="expiration-date">
							  				<span class="glyphicon glyphicon-calendar" style="color:#00a0cf"></span>
							  				<span class="h4" style="color:#00a0cf">&nbsp;&nbsp;CVC</span>
							  			</label>
							  			<br>
							  			<input placeholder="••••" style="width:100%" class="input-signup" type="text" id="debit-cvc-num">
							  		</div>
							  	</div>
					  		</div>
					  		<div style="margin-top:85px; text-align:center" class="row-fluid">
					  			<a target="_blank"href="http://stripe.com"><img src="/static/img/powered-stripe.png"></a>
					  		</div>
					</div>
			</div>
			<br>
			<div class="row">
				<div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-offset-4 col-md-4" style="padding-left:0px; padding-right:0px">
					<a id="submit-debit-card-info" href="javascript:void(0)">
						<div class="btn-save">
							<p>CASH OUT ${{user.balance}}
							</p>
						</div>
					</a>
				</div>
			</div>
		</div>
	</form>
</div>
<div id="cash-out-info" style="display:none; color:rgb(0, 159, 225);">
	<form role="form" action="javascript:void(0)" method="POST" id="payment-form">
		<div class="page-title">
			<div class="row-fluid" style="width:100%;text-align:center">
					<div class="col-xs-1 col-xs-offset-1 col-md-1">
   					<a href="javascript:void(0)" id="bank-account-confirm-back-link" style="text-decoration:none"> 
   						<h4 id="back-button"><span style="color:white" class="glyphicon glyphicon-chevron-left"></span> </h4>
   					</a>
					</div>
					<div class="col-xs-9 col-md-8" style="text-align:center">
						<h4 style="color:white;width:100%">CASH OUT CONFIRMATION</h4>
				</div>
			</div>
		</div>
		<div class="credit-main container-fluid">
			<br>
			<div class="row">
			  	<div class="user-profile" style="text-align:center">
			  		{% if user.profile_url %}
			  		<img src="{{user.profile_url}}" class="user-photo">
			  		{% else %}
			  		<img src="/static/img/default-photo.jpg" class="user-photo">
			  		{% endif %}
			  	</div>
			</div>
		  	<div class="row" style="text-align:center">
		  		<div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
			  		<h5 style="margin:25px auto;color:grey">Our payment system is securely <b>Powered by <a href="stripe.com">Stripe</a></b>, which handles all of the bank deposits. Uguru has no access to your bank information.</h5>
				  	<h6 style="margin:25px auto;color:grey">You will receive the funds in your account within <b>1-3</b> days depending on your bank. We will email you confirmation as soon as the money is successfully transfered.</h6>
				</div>
		  	</div>
			<div class="row">
				<div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-offset-4 col-md-4" style="padding-left:0px; padding-right:0px">
					<a id="cash-out-link-submit" href="javascript:void(0)">
						<div class="btn-save">
							<p>CASH OUT ${{user.balance}}
							</p>
						</div>
					</a>
				</div>
			</div>
		</div>
	</form>
</div>
{% endif %}


{% if address_book.keys() %}
	{% from '/macros/tutor-billing-form.html' import tutor_billing_form %}
	{% set keys = address_book.keys() %}
	{% set first_contact = keys[0] %}
	{{tutor_billing_form(address_book, first_contact)}}


{% endif %}

<div style="display:none" id="tutor-request">
	<div style="font-size:16px" id="student-request-fields">
	    <div class="container-fluid">
	    	<div id="already-have-active-request-alert" style="display:none" class="row-fluid">
  				<div style="margin-top:10px; text-align:center; float:center"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
  					<div style="margin-bottom:0"class="alert alert-danger">You already have an active request for this class. Once you've been matched with a tutor you can make another one!</div>
  				</div>
		  	</div>
		  	<div id="request-credit-card-success" style="display:none" class="row-fluid">
  				<div style="margin-top:10px; text-align:center; float:center"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
  					<div style="margin-bottom:0"class="alert alert-success">Your credit card has been successfully added!<br> Click 'request' to finalize your request.</div>
  				</div>
		  	</div>
		  	<div class='row margin-top-20' style='margin-bottom:-20px'>
		  		<div class='col-xs-12 col-sm-offset-3 col-sm-6 col-md-offset-4 col-md-4'>
		  			<a href='javascript:void(0)' class='blue-text' id='tutor-request-activity-back'>
	                    <span class='glyphicon glyphicon-chevron-left'>
	                    </span> Back
	                </a>
		  		</div>
		  	</div>
	        {% include 'request-form-container.html' %}
            
          <div style="margin-top:45px;text-align:center; color:grey">
		       Have questions? <a href="http://tinyurl.com/uguru-q-a" target="_blank"><u> Check out our FAQ</u></a>
		   </div>
	</div>
	</div>
</div>

{% include 'package-promotion.html'%}
{% include '/macros/payment-plans-home.html'%}


<div id="feed-messages">
		{% if not user.customer_id %}
		<!-- <div id='credit-modal' data-keyboard='True' class="modal fade">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-body">
                
                <div id='login-modal-container reg-text' class='container-fluid center'>
                    <div class='font-24 reg-text center'> Add a Card </div>
                    <div class='margin-top-10 reg-text margin-bottom-20 font-16 center padding-30'>
                    	You will not be charged until your Guru bills you at the end of the session.
                    </div>
                    <div class='row block align-left margin-bottom-10 padding-30'>
	                    <label class='reg-text'> Card Number </label>
			            <input placeholder="•••• •••• •••• ••••" style="width:100%" type="text" size="20" data-stripe="number" class='form-control standard-input float-left' id="credit-card-num-modal">
			        </div>

			        <div class='row block align-left margin-bottom-10 padding-30 relative'>
	                    <label class='reg-text'> Expiration Date </label>
			            <input placeholder="MM/YY" class='font-control reg-text standard-input block exp-date-month' size="20"type="text" data-stripe="exp-month" id='credit-card-exp-date-modal'>
			            <img class='float-right absolute powered-by-stripe-settings'src='/static/img/powered-stripe.png'> </img>
			        </div>
	                  
	                <div class='row-fluid block margin-top-20'>
	                    <a href='javascript:void(0);' id='submit-credit-card-modal'>
	                      <span class='blue-btn blue-btn-full margin-top-20'> Done! </span>
	                    </a>
	                </div>

	                <div id='add-credit-modal-alert' class='red-text font-12' style='display:none'>
                        Please fill in all fields.
                    </div>

                </div>
              </div>
            </div><! /.modal-content -->
          <!-- </div>/.modal-dialog
        </div>  -->
		{% endif %}
		{% for n in user.notifications|sort(attribute='time_created') %}
			{% if n.a_id_name == 'getting-started-guru'%}
			<div id='getting-started-guru-detailed' style='display:none'>
				<div class='row margin-top-40' id='tutor-app-details'>
	                <div class='col-xs-12 col-sm-offset-3 col-sm-6 col-md-offset-4 col-md-4'>
	                    <a href='javascript:void(0)' class='blue-text' id='guru-app-back-activity'>
	                        <span class='glyphicon glyphicon-chevron-left'>
	                        </span> Back
	                    </a>
	                    <div class='normal-text font-40 margin-top-20 reg-text center'>
	                        The Guru Rules
	                    </div>
	                    <div class='margin-top-40'>
	                        <div class='font-20 align-left reg-text margin-bottom-5'>Free Sessions?</div>
	                        <p>
	                            To ensure quality, you will give 1 or more free sessions to students. As soon as you have an average review of 4.0 or above, you will become an official tutor, and you can start charging! If you get a 4 or 5 star review on your first one, you will be good to go!
	                        </p>
	                    </div>

	                    <div class='margin-top-40'>
	                        <div class='font-20 align-left reg-text margin-bottom-5'>Money Back Guarantee</div>
	                        <p>
	                            If a student is unhappy with your service (a 3 star review or below), the student can request his/her money back. We will carefully evaluate individual cases to prevent abuse.
	                        </p>
	                    </div>

	                    <div class='margin-top-40'>
	                        <div class='font-20 align-left reg-text margin-bottom-5'>Next Steps</div>
	                        <p>
	                            Just sit tight and wait! You will start recieving tutoring requests. Be sure to respond quickly.
	                        </p>
	                    </div>
	                </div>
	            </div>
	        </div>
			{% endif %}
			{% if n.a_id_name == 'getting-started-tutor' %}
				<div id="{{n.a_id_name}}-detailed" style="display:none;">
					<div class="page-title">
	   					<div class="row-fluid" style="width:100%;text-align:center">
		   					<div class="col-xs-1 col-xs-offset-1 col-sm-offset-1 col-sm-1 col-md-offset-1 col-md-1">
			   					<a href="javascript:void(0)" class= "feed-message-link" style="text-decoration:none"> 
			   						<h4 id="back-button"><span style="color:white" class="glyphicon glyphicon-chevron-left"></span> </h4>
			   					</a>
		   					</div>
		   					<div class="col-xs-9 col-sm-8 col-md-8" style="text-align:center">
	   							<h4 style="color:white;width:100%">TUTORING REQUEST</h4>
	   						</div>
	   					</div>
	  				</div>
					<div class="container-fluid" align="center" style="margin-left:20px;margin-right:20px">
					  	<div style="margin-top:15px" class="row">
						  	<div class="col-xs-12 col-md-offset-3 col-md-6 col-sm-offset-3 col-sm-6">
						  		<div style="margin-bottom:10px"class="alert alert-danger">
								  <strong>NOTE:</strong> This is just an EXAMPLE, go ahead and click
								  <strong> ACCEPT</strong> 
								</div>
						  	</div>
						 </div>
					  	<img src="/static/img/jenny.jpg" style="align:center" class="user-photo">
					  <h5 style="text-align:center"><b>Jenny</b> needs help in <b>CS10</b></h5>
					  <div class="row">
						  <div class="request-info col-xs-12 col-sm-offset-2 col-sm-8 col-md-6 col-md-offset-3">
							  <div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Description</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">Need help understanding the concept of recursion</div>
							  		</div>
							  </div>
							  <div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Availability</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">Monday 6-8pm</div>
							  		</div>
							  </div>
							  <div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Preferred Location</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">Dwinelle</div>
							  		</div>
							  </div>
							  <div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Professor</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">
							  				Hilfinger
							  			</div>
							  		</div>
							  </div>
							  <div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Estimated Session Time</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><span id="student-time-estimate-{{loop.index}}">2</span>&nbsp;hours</div>
							  		</div>
							  </div>
							</div>
						</div>
							<div style="text-align:center; margin-top:10px; color:grey">
								You will be making: <br>
								<span style="color:#69bf69; font-size:30px"><strong>$<span id="student-offer-total-price-{{loop.index}}">26</span> </strong></span><br>
								<span style="color:grey; font-weight:300; font-size:14px">($<span id="student-offer-hourly-price-{{loop.index}}">13</span>/hr)</span>
							</div>
							<a style="text-align:center;" id="tutor-change-price-link-{{loop.index}}" class="tutor-change-price-link" href="javascript:void(0);">
								<div style="margin-top:10px;color:rgb(0, 159, 225)"> Change the price
								</div>
							</a>
					</div>
					<div class="row" style="display:none; text-align:center; margin-top:15px; margin-bottom:30px" id="tutor-change-price-slider-div-{{loop.index}}">
				    	<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-6 col-md-offset-3">
				    		<div style="margin:auto; width:75%" id="tutor-change-price-slider-{{loop.index}}" class="tutor-change-price-slider"></div>
				    	</div>
				    	<br>
				    	<a style="text-align:center;" class="tutor-change-price-cancel" id="tutor-change-price-cancel-{{loop.index}}" href="javascript:void(0);">
									<div style="margin-top:10px;color:rgb(0, 159, 225)"> Cancel
									</div>
						</a>
				    </div>
				    <br>
					<div class="row">
						<div id="launch-profile-div" class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-offset-4 col-md-4" style="padding-left:0px; padding-right:0px; margin-top:0px; margin-bottom:5px; display:block">
				          <a id="launch-profile-link" href="/messages/">
				            <div class="btn-save">
				              <p>ACCEPT
				              </p>
				            </div>
				          </a>
				        </div>
				     </div>
			        <div style="text-align:center; color:grey">
			        	<i>or ignore this request if you're not interested.</i>
			        </div>

				</div>
			{% elif n.custom_tag == 'tutor-cashed-out' %}
				<div id="{{n.a_id_name}}-detailed" style="display:none;">
					<div class="page-title">
	   					<div class="row" style="width:100%;text-align:center">
		   					<div class="col-xs-1 col-xs-offset-1 col-sm-offset-1 col-sm-1">
			   					<a href="javascript:void(0)" class= "feed-message-link" style="text-decoration:none"> 
			   						<h4 id="back-button"><span style="color:white" class="glyphicon glyphicon-chevron-left"></span> </h4>
			   					</a>
		   					</div>
		   					<div class="col-xs-9 col-sm-9" style="text-align:center">
	   							<h4 style="color:white;width:100%">CASH OUT RECEIPT</h4>
	   						</div>
	   					</div>
	  				</div>
					<div class="container-fluid" align="center" style="margin-left:20px;margin-right:20px">
					  	<div style="margin-top:15px" class="row">
						  	<div class="col-xs-12">
						  		<div style="margin-bottom:10px"class="alert alert-info">
								  Keep checking here to see the status of your transfer. Typically transfers take 1-3 days depending on your bank.
								</div>
						  	</div>
						 </div>
					  	<img src="{{user.profile_url}}" style="align:center" class="user-photo">
					  <h5 style="text-align:center"><b>You</b> cashed out <b>${{n.custom}}</b></h5>
					  <div class="row">
						  <div class="request-info col-xs-12 col-sm-offset-2 col-sm-8 col-md-6 col-md-offset-3">
							  <div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Date Cashed Out</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">{{n.time_created}}</div>
							  		</div>
							  </div>
							  <div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Amount</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">${{n.custom}}</div>
							  		</div>
							  </div>
							  <div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Bank Name</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">{{n.skill_name}}</div>
							  		</div>
							  </div>
							  <div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Status</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div style="color:red"class="h4 request-info-row">{{n.status}}</div>
							  		</div>
							  </div>
							</div>
						</div>
					</div>
				</div>

			{% elif n.custom_tag == 'student-payment-proposal-' %}
				{% set payment = payment_dict[n.payment_id]['payment'] %}
				{% set tutor_name = payment_dict[n.payment_id]['tutor_name'] %}
				<div class="payment-id-{{payment.id}}"id="{{n.a_id_name}}-detailed" style="display:none">
					<div class="page-title">
							<a class="feed-message-link" href="javascript:void(0)"style="float:left; margin-bottom:5px; color:white; text-decoration:none"> 
								< 
							</a>
							<h4 style="color:white;width:100%"></h4>
					</div>
					<div class="offer" align="center" style="margin-left:20px;margin-right:20px">
						<img id="payment-student-img" src="/static/img/guru.jpg" class="user-photo">
						<h4 style="text-align:center">Payment request from <b> {{tutor_name}}
						</b></h4>
						<br>
						<div class="bio" style="padding-bottom:20px">
							<div style="float:left;text-align:right;width:50%;padding-right:20px">
							  	<div class="h4"><b>Rate</b></div>
							  	<div class="h4"><b>Time</b></div>
							  	<div class="h4"><b>Total</b></div>
							</div>
							<div style="float:right;text-align:left;width:50%;">
								<div class="h4" style="color:#69bf69;">
									<span> ${{payment.tutor_rate}}/hour</span>
								</div>
								<div> {{payment.time_amount}} hours </div>
								<div id="total-payment-amount" style="color:#69bf69;font-size:36px">${{payment.tutor_rate * payment.time_amount}}
								</div>
								<h6>({{payment.time_amount}} x ${{payment.tutor_rate}}/hr)</h6>
							</div>
						</div>
					</div>
				<a href="javascript:void(0)" id="accept-payment">
					<div class="btn-request">ACCEPT
					</div>
				</a>
			</div>	
			{% elif n.custom_tag == 'student-payment-approval' %}
				{% set payment = payment_dict[n.payment_id]['payment'] %}
				{% set tutor_name = payment_dict[n.payment_id]['tutor_name'] %}
				<div class="payment-id-{{payment.id}}"id="{{n.a_id_name}}-detailed" style="display:none">
					<div class="page-title">
							<a class="feed-message-link" href="javascript:void(0)"style="float:left; margin-bottom:5px; color:white; text-decoration:none"> 
								< 
							</a>
							<h4 style="color:white;width:100%">Request Payment</h4>
					</div>
					<div class="offer" align="center" style="margin-left:20px;margin-right:20px">
						<img id="payment-student-img" src="/static/img/guru.jpg" class="user-photo">
						<h4 style="text-align:center">You have paid  <b> {{tutor_name}}
						</b></h4>
						<br>
						<div class="bio" style="padding-bottom:20px">
							<div style="float:left;text-align:right;width:50%;padding-right:20px">
							  	<div class="h4"><b>Rate</b></div>
							  	<div class="h4"><b>Time</b></div>
							  	<div class="h4"><b>Total</b></div>
							</div>
							<div style="float:right;text-align:left;width:50%;">
								<div class="h4" style="color:#69bf69;">
									<span> ${{payment.tutor_rate}}/hour</span>
								</div>
								<div> {{payment.time_amount}} hours </div>
								<div id="total-payment-amount" style="color:#69bf69;font-size:36px">${{payment.tutor_rate * payment.time_amount}}
								</div>
								<h6>({{payment.time_amount}} x ${{payment.tutor_rate}}/hr)</h6>
							</div>
						</div>
					</div>
			</div>		
			{% elif n.custom_tag == 'tutor-receive-payment' %}
				{% set payment = payment_dict[n.payment_id]['payment'] %}
				{% set tutor_name = payment_dict[n.payment_id]['tutor_name'] %}
				{% set student_name = payment_dict[n.payment_id]['student_name'] %}
				<div class="payment-id-{{payment.id}}"id="{{n.a_id_name}}-detailed" style="display:none">
					<div class="page-title">
							<a class="feed-message-link" href="javascript:void(0)"style="float:left; margin-bottom:5px; color:white; text-decoration:none"> 
								< 
							</a>
							<h4 style="color:white;width:100%">Request Payment</h4>
					</div>
					<div class="offer" align="center" style="margin-left:20px;margin-right:20px">
						<img id="payment-student-img" src="/static/img/guru.jpg" class="user-photo">
						<h4 style="text-align:center">Payment received from <b> {{student_name}}
						</b></h4>
						<br>
						<div class="bio" style="padding-bottom:20px">
							<div style="float:left;text-align:right;width:50%;padding-right:20px">
							  	<div class="h4"><b>Rate</b></div>
							  	<div class="h4"><b>Time</b></div>
							  	<div class="h4"><b>Total</b></div>
							</div>
							<div style="float:right;text-align:left;width:50%;">
								<div class="h4" style="color:#69bf69;">
									<span> ${{payment.tutor_rate}}/hour</span>
								</div>
								<div> {{payment.time_amount}} hours </div>
								<div id="total-payment-amount" style="color:#69bf69;font-size:36px">${{payment.tutor_rate * payment.time_amount}}
								</div>
								<h6>({{payment.time_amount}} x ${{payment.tutor_rate}}/hr)</h6>
							</div>
						</div>
					</div>
			</div>
			{% elif n.custom_tag == 'next-time' %}
				{{notification_details_template(user, n, request_dict, time, loop.index, tutor_dict)}}
			{% elif n.custom_tag == 'confirm-meeting' %}
				{{notification_details_template(user, n, request_dict, time, loop.index, tutor_dict)}}
			{% elif n.custom_tag == 'student-request-help' %}
				{{notification_details_template(user, n, request_dict, time, loop.index, tutor_avg_rating)}}
				<!-- <div id="{{n.a_id_name}}-detailed" style="display:none;">
	  				<div style="display:block;"class="page-title">
	   					<div class="row" style="width:100%;text-align:center">
		   					<div class="col-xs-1 col-sm-offset-1 col-sm-1 col-md-offset-1 col-md-1">
			   					<a href="javascript:void(0)" class= "feed-message-link" style="text-decoration:none"> 
			   						<h4 id="back-button"><span style="color:white" class="glyphicon glyphicon-chevron-left"></span> </h4>
			   					</a>
		   					</div>
		   					<div class="col-xs-11 col-sm-8 col-md-8" style="text-align:center">
	   							<h4 style="color:white;width:100%">YOUR {{n.custom|upper}} REQUEST</h4>
	   						</div>
	   					</div>
	  				</div>
	  				<div class="request-details">
						<div class="container-fluid" align="center" style="margin-left:20px;margin-right:20px; display:block">
						  	{% if not (request_dict[n.request_id]['request'].requested_tutors ) %}
				  			<div id="already-have-active-request-alert" style="display:show;" class="row">
		                        <div style="margin-top:10px; float:center; margin:10px auto"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
		                          <div style="margin-bottom:0"class="alert alert-danger">Sorry! We currently don't have tutors for this course. <br>We've registered your request for the time being and will let you know if we find tutors.<br>
		                          Unfortunately we are mainly focusing on lower div courses at the moment.</div>
		                        </div>
		                    </div>
		                    {% elif n.status == 'EXPIRED' %}
				  			<div style="display:block;" class="row">
				  				<div style="margin-top:10px; float:center; margin:10px auto"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
				  					<div style="margin-bottom:0"class="alert alert-danger">This request has expired. Please make another one!</div>
				  				</div>
				  			</div>
			  				{% elif not (request_dict[n.request_id]['request'].connected_tutor_id == user.id) %}
			  				<div style="display:block;" class="row">
				  				<div style="margin-top:10px; float:center; margin:10px auto;"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
				  					<div style="margin-bottom:0;"class="alert alert-info">Sit tight and wait! <br>We will email you each time a tutor has agreed to help. </div>
				  				</div>
				  			</div>
				  			{% else %}
				  			<div style="display:block;" class="row">
				  				<div style="margin-top:10px; float:center; margin:10px auto"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
				  					<div style="margin-bottom:0"class="alert alert-danger">You canceled this request.</div>
				  				</div>
				  			</div>
				  			{% endif %}
						  	{% if user.profile_url %}
						  	<img src="{{user.profile_url}}" style="align:center" class="user-photo">
						  	{% endif %}
						  <div class="row">
							  <div class="request-info col-xs-12 col-sm-offset-2 col-sm-8 col-md-6 col-md-offset-3">
								  	<div class="row-fluid">
								  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row"><b>Description</b></div>
								  		</div>
								  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].description}}</div>
								  		</div>
								  	</div>
								  	<div class="row-fluid">
								  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row"><b>Location</b></div>
								  		</div>
								  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].location}}</div>
								  		</div>
								  	</div>
								  	<div class="row-fluid">
								  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row"><b>Availability</b></div>
								  		</div>
								  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row">
								  				  {% if request_dict[n.request_id]['student-calendar'] %}
								  					<span class='grey-text'> See times: </span> 

						                            <a id='request-calendar-toggle' onclick='show_student_request_calendar({{request_dict[n.request_id]["student-calendar"]}}, {{time.mktime(request_dict[n.request_id]["request"].time_created.timetuple())}})'>
						                                <span class='glyphicon glyphicon-calendar'></span>
						                           	</a>
					                              {% else %}
					                              	
					                              	{{request_dict[n.request_id]['request'].availability}}

					                              {% endif %}
								  			</div>
								  		</div>
								  	</div>
								  	{% if request_dict[n.request_id]['request'].professor %}
								  	<div class="row-fluid">
								  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row"><b>Professor</b></div>
								  		</div>
								  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].professor}}
								  			</div>
								  		</div>
								  	</div>
								  	{% endif %}
								  	<div class="row-fluid">
								  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row"><b>Requested Hourly Price</b></div>
								  		</div>
								  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row">${{request_dict[n.request_id]['request'].student_estimated_hour}}</div>
								  		</div>
								  	</div>
								  	<div class="row-fluid">
								  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row"><b>Estimated Session Time</b></div>
								  		</div>
								  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].time_estimate}} hours</div>
								  		</div>
								  	</div>
								  	<div class="row-fluid">
								  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4"><b>Requested Total Price</b></div>
								  		</div>
								  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
								  			<div class="h4">${{(request_dict[n.request_id]['request'].time_estimate * request_dict[n.request_id]['request'].student_estimated_hour)}}</div>
								  		</div>
								  	</div>
								</div>
						 	</div>
						 	{% if request_dict[n.request_id]['request'].requested_tutors|length > 0 %}
						 	<div style="text-align:center; float:center; margin-top:10px" class="row">
						 		<h4>Contacted Tutors</h4>
						 		<div id="contacted-tutors">
						 		{% for tutor in request_dict[n.request_id]['request'].requested_tutors %}
						 		<span>
						 			<img src="{{tutor.profile_url}}" style="align:center" class="tutor-photo"> 
						 		</span>
						 		{% endfor %}
						 		</div>
						 	</div>
						 	{% endif %}
						 	{% if not request_dict[n.request_id]['request'].connected_tutor_id and not n.status == 'EXPIRED' %}
						 	<!-- <div style="text-align:center; float:center; margin-top:20px; font-size:14px; color:grey;" class="row">
						 		<a class="edit-request" style="color:grey" href="javascript:void(0)"> (Click here to edit this request) </a>
						 	</div> -->
						 	<!-- <div style="text-align:center; float:center; margin-top:20px; font-size:10px; color:grey;" class="row">
						 		<a class="cancel-request" style="color:grey" href="javascript:void(0)"> Cancel this Request </a>
						 	</div> 
						 	{% endif %}
					</div>
					</div> 
					{% if not request_dict[n.request_id]['request'].connected_tutor_id %}
					<div style="display:none; color:#00a9e5" class="edit-request">
					    <div class="container-fluid">
					    	<div style="display:show" class="row-fluid">
				  				<div style="margin-top:10px; text-align:center; float:center"class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
				  					<div style="margin-bottom:0"class="alert alert-info">Edit your request carefully! Each time you do, tutors are notified.</div>
				  				</div>
						  	</div>
					        <div class="row" style="margin-top:15px">
				                <div class="edit-request-additional row">
				                      <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
				                        <div class="form-group">
				                            <label for="exampleInputEmail1"><strong>SPECIFY TOPICS AND GURU PREFERENCES</strong></label> <br>
				                            <input style="width:100%"id="student-signup-description" name="skill" type="email" class="input-signup" placeholder="Data Structures, Midterm Prep, with Prof Hilfinger" id="login-email" value="{{request_dict[n.request_id]['request'].description}}">
				                        </div>
				                      </div>
				                </div>
				                <div class="edit-request-availability row">
				                   	<div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
				                        <div class="form-group">
			                              <label for="exampleInputEmail1"><strong>YOUR AVAILABILITY (BE SPECIFIC) </strong></label> <br>
			                              <input style="width:100%"id="student-signup-availability" name="skill" type="email" class="input-signup" value="{{request_dict[n.request_id]['request'].available_time}}"placeholder="Anytime tonight, Mon 3-6pm, Sat morning" id="login-email">
				                        </div>
				                    </div>
				                </div>
				               	<div class="edit-request-location row">
				                    <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
				                        <div class="form-group">
				                            <label for="exampleInputEmail1"><strong>PREFERRED LOCATION</strong></label> <br>
				                              	<input style="width:100%"id="student-signup-location" name="skill" type="email" class="input-signup" value="{{request_dict[n.request_id]['request'].location}}"placeholder="Dwinelle, Peets Coffee, SLC" id="login-email">
				                         </div>
				                    </div>
				                </div>
			                    <div class="edit-request-time-length row">
			                        <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
			                            <div class="form-group">
											<label for="exampleInputEmail1"><strong>HOW LONG WOULD IT TAKE</strong></label> <br>
			                                <div id="time-estimate-slider-request-{{outgoing_request_index[request_dict[n.request_id]['request']]}}" style="margin-top:7px; margin-bottom:5px"></div>
			                                <p style="margin-left:5px; font-size:14px; margin-top:3px; font-weight:700"class="text-left"><span style="font-size:14px;color:rgb(0, 159, 225)" name="estimate" id="time-estimate-request-{{outgoing_request_index[request_dict[n.request_id]['request']]}}"></span> hours (This is only an estimate)</p>
			                            </div>
			                        </div>
			                    </div>
			                    <div class="edit-request-price row">
			                        <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
			                            <div class="form-group">
											<label for="exampleInputEmail1"><strong>PRICE YOU ARE WILLING TO PAY</strong></label> <br>
			                                <div id="hourly-price-slider-request-{{outgoing_request_index[request_dict[n.request_id]['request']]}}" style="margin-top:7px; margin-bottom:5px"></div>
			                                <p style="margin-left:5px; font-size:14px;color:#69bf69; margin-top:3px; font-weight:700"class="text-left">$<span style="font-size:14px;" name="estimate" id="hourly-price-request-{{outgoing_request_index[request_dict[n.request_id]['request']]}}"></span></p>
			                            </div>
			                        </div>
			                    </div>
				            <div style="text-align:center; margin-right:-15px; margin-left:-15px; padding-left:0px; padding-right:0px;" class="row">
				              <div style="padding-left:0px; padding-right:0px"class="col-xs-12 col-md-offset-4 col-md-4 col-sm-offset-3 col-sm-6">
				                <a class="edit-request-submit" href="javascript:void(0)">
				                  <div class="tutor-submit-next">
				                    <p> EDIT REQUEST </p>
				                  </div>
				                </a>
				              </div>
				            </div>
				            {% if not request_dict[n.request_id]['request'].connected_tutor_id %}
						 	<div style="text-align:center; float:center; margin-top:20px; font-size:10px; color:grey;" class="row">
						 		<a class="cancel-request" style="color:grey" href="javascript:void(0)"> Cancel this Request </a>
						 	</div>
						 	{% endif %}
				          <div style="margin-top:25px;text-align:center; color:grey">
						       Have questions? <a href="http://tinyurl.com/uguru-q-a" target="_blank"><u> Check out our FAQ</u></a>
						   </div>
						</div>
					</div>
				</div>
					{% endif %}
				</div> -->
			{% elif n.custom_tag  == 'student-incoming-offer' %}
			{{notification_details_template(user, n, request_dict, time, loop.index, tutor_dict, variations)}}
				<!-- <div id="{{n.a_id_name}}-detailed" style="display:none;">
					<div class="page-title">
	   					<div class="row-fluid" style="width:100%;text-align:center">
		   					<div class="col-xs-1 col-xs-offset-1 col-sm-offset-1 col-sm-1 col-md-offset-1 col-md-1">
			   					<a href="javascript:void(0)" class= "feed-message-link" style="text-decoration:none"> 
			   						<h4 id="back-button"><span style="color:white" class="glyphicon glyphicon-chevron-left"></span> </h4>
			   					</a>
		   					</div>
		   					<div class="col-xs-8 col-sm-8 col-md-8" style="text-align:center">
	   							<h4 style="color:white;width:100%">TUTORING PROPOSAL FROM {{tutor_dict[n].name.split()[0]|upper}}</h4>
	   						</div>
	   					</div>
	  				</div>
	  				{% if n.custom == 'student-accept-request' and not (request_dict[n.request_id]['request'].connected_tutor_id == user.id) %}
	  				<br>
					<div class="row">
						<div class="next-steps-border col-xs-12 col-sm-offset-2 col-sm-8 col-md-4 col-md-offset-4">
							<div id="flakers-fee-alert" style="text-align:center; margin-bottom:10px;font-size:24px; ">
									<b>NEXT STEPS</b>
							</div>
							<div style="font-size:14px; text-align:left;">
								<p>1. Message your Guru, and finalize meetup <b>time & location</b>. </p>
								<p>2. <b>No need to bring cash!</b> After the session, just give your Guru your <b>secret payment code</b> (on top of your homepage).</p>
								<p>3. <b>Review</b> your Guru after the session by logging in. </p>
							</div>
						</div> 
						<div id="launch-profile-div" class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-offset-4 col-md-4" style="padding-left:0px; padding-right:0px; margin-top:20px; margin-bottom:20px; display:block">
				          <a id="launch-profile-link" href="/messages/">
				            <div class="btn-save">
				              <p>MESSAGE GURU NOW
				              </p>
				            </div>
				          </a>
				        </div>
			    	</div>
			    	<div class="row">
						<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-4 col-md-offset-4" style="margin-bottom:-20px; margin-top:20px">
						    <div id="flakers-fee-alert" style="text-align:center; font-size:16px; color:grey;">
									<i><b>REQUEST INFO</b></i>
							</div>
						</div>
					</div>
					{% endif %}
					{% if n.status == 'EXPIRED' %}
					<div class="row-fluid">
					  	<div style="margin:auto; text-align:center; float:center; margin-top:10px;"class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
						  	<div class="alert alert-danger" style="margin-bottom:0px;">
						  		This opportunity to connect has been expired
						  	</div>
						</div>
					</div>
					{% endif %}
					{% if (request_dict[n.request_id]['request'].connected_tutor_id == user.id) %}
					<div class="row-fluid">
					  	<div style="margin:auto; text-align:center; float:center; margin-top:10px;"class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
						  	<div class="alert alert-danger" style="margin-bottom:0px;">
						  		You canceled this request
						  	</div>
						</div>
					</div>
					{% endif %}
					{% if not n.request_tutor_amount_hourly %}
					<div class="row-fluid">
					  	<div style="margin:auto; text-align:center; float:center; margin-top:10px;"class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
						  	<div class="alert alert-danger" style="margin-bottom:0px;">
						  		Unfortunately the tutor cannot accommodate your request anymore. 
						  	</div>
						</div>
					</div>
					{% endif %}
	  				<div class="container-fluid" align="center" style="margin-left:20px;margin-right:20px">
					  	<div id="credit-card-success" style="display:None; color:green; text-align:center" class="row">
							<br>Credit Card Successfully Added! 
						</div>
					  	<br>
					  	{% if tutor_dict[n] and tutor_dict[n].profile_url %}
					  	<img src="{{tutor_dict[n].profile_url}}" style="align:center" class="user-photo">
					  	{% else %}
					  	<img src="/static/img/default-photo.jpg" style="align:center" class="user-photo">
					  	{% endif %}
						<div class="row">
						  	<div class="col-xs-12 col-sm-offset-3 col-sm-6 col-md-4 col-md-offset-4">
						  		<h5 style="text-align:center; margin:3px auto">
						  			{{tutor_dict[n].name.split()[0]}}
						  		</h5>
						  	</div>
						  	<div class="col-xs-12 col-sm-offset-3 col-sm-6 col-md-4 col-md-offset-4">
						  		<h5 style="text-align:center; margin:3px auto">
						  		<b>Year:</b> {{tutor_dict[n].year}}, <b>Major:</b> {{tutor_dict[n].major}}
						  		</h5>
						  	</div>
						  	{% if tutor_dict[n].tutor_introduction %}
						  	<div class="col-xs-12 col-sm-offset-3 col-sm-6 col-md-4 col-md-offset-4">
						  		<h5 style="text-align:center; margin:3px auto">
						  		<b>Introduction:</b> {{tutor_dict[n].tutor_introduction}}
						  		</h5>
						  	</div>
						  	{% endif %}
						  	{% if tutor_dict[n].previous_tutor or tutor_dict[n].hkn_tutor or tutor_dict[n].slc_tutor or tutor_dict[n].res_tutor or tutor_dict[n].ta_tutor or tutor_dict[n].la_tutor %}
						  	<div class="col-xs-12 col-sm-offset-3 col-sm-6 col-md-4 col-md-offset-4">
						  		<h5 style="text-align:center; margin:7px auto">
						  		<b>Relevant Experience:</b> <br> 
						            <div style="margin-top:10px">
						            {% if tutor_dict[n].previous_tutor %}
					                <span style="margin-left:0px"class="example-tag active" >
					                  <span># I have tutoring experience at Cal </span> &nbsp;&nbsp;
					                </span>
					                {% endif %}
					                {% if tutor_dict[n].slc_tutor %}
					                <span style="margin-left:0px"class="example-tag active" >
					                  <span># SLC Tutor </span> &nbsp;&nbsp;
					                </span>
					                {% endif %}
					                {% if tutor_dict[n].hkn_tutor %}
					                <span style="margin-left:0px"class="example-tag active" >
					                  <span># HKN Tutor </span> &nbsp;&nbsp;
					                </span>
					                {% endif %}
					                {% if tutor_dict[n].res_tutor %}
					                <span style="margin-left:0px"class="example-tag active" >
					                  <span># Residential Hall Tutor </span> &nbsp;&nbsp;
					                </span>
					                {% endif %}
					                {% if tutor_dict[n].ta_tutor %}
						                <span style="margin-left:0px"class="example-tag active" >
					                  		<span># TA or GSI </span> &nbsp;&nbsp;
					                	</span>
						            {% endif %}
						            {% if tutor_dict[n].la_tutor %}
						                <span style="margin-left:0px"class="example-tag active" >
					                  		<span># Lab Assistant </span> &nbsp;&nbsp;
					                	</span> 
						            {% endif %}
						        	</div>
						  		</h5>
						  	</div>
						  	{% endif %}
						  	{% if n.extra_detail %}
						  	<div class="col-xs-12 col-sm-offset-3 col-sm-6 col-md-4 col-md-offset-4">
						  		<h5><b> A Personal Note from {{tutor_dict[n].name.split()[0]}}</b></h5>
						  		<h5 style="margin-top:0px; color:grey;"><i>"{{n.extra_detail}}"<br></i></h5>
						  	</div>
						  	{% endif %}
						</div>
						<div class="row">
							{% if n.request_tutor_amount_hourly %}
								{% set original_student_price = (request_dict[n.request_id]['request'].student_estimated_hour ) %}
									{% set most_recent_price = n.request_tutor_amount_hourly  %}
								{% if original_student_price - most_recent_price != 0 %}
									{% set price_has_changed = True %}
								{% else %}
									{% set price_has_changed = False %}
								{% endif %}
							{% endif %}
						  <div class="request-info col-xs-12 col-sm-offset-2 col-sm-8 col-md-6 col-md-offset-3">
							  	<div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Description</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].description}}</div>
							  		</div>
							  	</div>
							  	<div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Location</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].location}}</div>
							  		</div>
							  	</div>
							  	<div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Availability</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">
							  				{% if request_dict[n.request_id]['student-calendar'] %}
							  				<span class='grey-text'> See chosen time: </span> 
				                              <a id='request-calendar-toggle' onclick='show_tutor_request_submitted_calendar({{request_dict[n.request_id]["student-calendar"]}}, {{request_dict[n.request_id]["tutor-calendars"][tutor_dict[n].id]}}, false, {{time.mktime(request_dict[n.request_id]["request"].time_created.timetuple())}})'>
				                                <span class='glyphicon glyphicon-calendar'></span>
				                              </a>
				                            {% else %}
				                            	{{request_dict[n.request_id]['request'].availability}}
				                            {% endif %}
							  			</div>
							  		</div>
							  	</div>
							  	{% if request_dict[n.request_id]['request'].professor %}
							  	<div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Professor</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].professor}}
							  			</div>
							  		</div>
							  	</div>
							  	{% endif %}
							  	<div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Hourly Price</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">
							  				{% if n.request_tutor_amount_hourly %}
							  					${{(n.request_tutor_amount_hourly)}} 
							  				{% else %}
							  				Canceled
							  				{% endif %}
							  			</div>
							  		</div>
							  	</div>
							  	<div class="row-fluid">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Estimated Session Time</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].time_estimate}} hours</div>
							  		</div>
							  	</div>
							  	{% if n.request_tutor_amount_hourly %}
							  	<div class="row">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4"><b>Estimated Total Price</b><br>
							  			</div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4">${{request_dict[n.request_id]['request'].time_estimate * n.request_tutor_amount_hourly}}<br></div>
							  		</div>
							  	</div>
							  	{% endif%}
								
								{% if n.request_tutor_amount_hourly %}
								<div style="text-align:center; margin-top:10px; color:grey">
									{% if price_has_changed %}
									<div style="font-size:14px; margin-top:10px; color:rgb(0, 159, 225)">
											The tutor changed the price from ${{(request_dict[n.request_id]['request'].student_estimated_hour)}}/hr to ${{(n.request_tutor_amount_hourly)}}/hr 
									</div>
									{% else %}
									<div style="font-size:14px; margin-top:10px; color:rgb(0, 159, 225)">
											The tutor has accepted your original asking price!
									</div>
									{% endif %}
								</div>
								{% endif %}
						 	</div>
						  </div>
						<br>
  					</div>
  					<div class="modal fade" id="modal-{{n.a_id_name}}"tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
					  <div style="margin:10% auto"class="modal-dialog modal-lg">
					    <div class="modal-content">
					      <div class="modal-header">
					        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					        <h4 style="text-align:center"class="modal-title" id="myModalLabel">CANCEL CURRENT CONNECTION</h4>
					      </div>
					      <div style="color:grey; text-align:center" class="modal-body cancel-request">
					        <h4 style="">Are you sure you want to disconnect with your current matched tutor? <h4>
					        <div class="row">
						        <div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-2 col-md-8">
						        	<h5 style="color:grey;margin-top:15px;">This means that your conversation with your current matched tutor will be deleted and they will be notified. <strong>You will not be able to reconnect with this tutor again.</strong></h5>
						       	</div>
						    </div>
					        <h6 style="color:grey;margin-top:15px;margin-bottom:0px;">If so, click 'next' below.</h6>
					      </div>
					      <div id="radio-group"style="display:none; color:grey" class="modal-body cancel-confirm">
					        <div style="text-align:center; color:red; display:none" class="radio-alert row-fluid">
					        	You must check at least one of the options
					       	</div>
					        <div style="text-align:center" class="row-fluid">
					        	<h5> Please provide feedback on why you are canceling this request </h5>
					        </div>
					        <div style="margin-left:28%"class="radio">
							  <label>
							    <input type="radio" class="radio-{{n.a_id_name}}" name="whyCancel">
							    Tutor cannot make the time I want to meet
							  </label>
							</div>
							<div style="margin-left:28%" class="radio">
							  <label>
							    <input type="radio" class="radio-{{n.a_id_name}}"  name="whyCancel">
							    Other tutors had more experience
							  </label>
							</div>
							<div style="margin-left:28%" class="radio">
							  <label>
							    <input type="radio" class="radio-{{n.a_id_name}}"  name="whyCancel">
							    Price was out of my budget
							  </label>
							</div>
							<div style="margin-left:28%" class="radio">
							  <label>
							    <input type="radio" class="radio-{{n.a_id_name}}"  name="whyCancel">
							    Found other source of help
							  </label>
							</div>
							<div style="margin-left:28%" class="radio">
							  <label>
							    <input type="radio" class="radio-{{n.a_id_name}}"  name="whyCancel">
							    Other
							  </label>
							</div>
					      </div>
					      <div class="modal-footer">
					        <div id="launch-profile-div" class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-offset-4 col-md-4" style="padding-left:0px; padding-right:0px; display:block">
					          <a class="cancel-request-next" href="javascript:void(0)">
					            <div class="btn-save">
					              <p>NEXT
					              </p>
					            </div>
					          </a>
					        </div>
					      </div>
					    </div>
					  </div>
					</div>
  					{% if request_dict[n.request_id]['request'].connected_tutor_id and request_dict[n.request_id]['request'].connected_tutor_id != tutor_dict[n].id %}
  					{{tutor_dict[n].id}}
  						<div class="row" style="text-align:center;color:red">You accepted another tutor's request for this subject. <br>If you want to reconnect with another tutor, <a data-toggle="modal" data-target="#modal-{{n.a_id_name}}" href="#"> click here </a>.<br>
  						</div>
  						<div class="row" style="text-align:center; color:grey">If you want your one-time connection fee for this request to be refunded, please email support@uguru.me for a quick response.</div>
  					{% elif n.custom != 'student-accept-request' and n.request_tutor_amount_hourly and not (request_dict[n.request_id]['request'].connected_tutor_id == user.id) and not (n.status == 'EXPIRED')%}
					<div class="are-you-sure"style="display:none;text-align:center; color:red; font-size:14px" class="row"> 
						<div style="margin-bottom:10px;"class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-offset-3 col-md-6">
							If you want to accept this request, you agree to this. <br>If you do, go ahead and click 'CHOOSE THIS GURU' 
						</div>
					</div>
					<div class="row" style="margin-bottom:5px; font-size: 14px; text-align:center; color:#CD2626">
						{% if request_dict[n.request_id]['request'].id > 165 %}
						{% set connection_fee = 5 %}
						{% else %}
						{% set connection_fee = 10 %}
						{% endif %}
						<div> We charge a one-time, ${{connection_fee}} fee to match you with 
				    	{{tutor_dict[n].name.split()[0]}}. <br>
				    	This connection fee only applies to your first session with {{tutor_dict[n].name.split()[0]}}.
				    	</div>
				    	<div style="color:grey;margin-top:5px; margin-bottom:5px">If things don’t work out, you can connect to a different Guru, or be instantly refunded.
				    	</div>
				    </div>
					<div class="row">
						<div id="launch-profile-div" class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-offset-4 col-md-4" style="padding-left:0px; padding-right:0px; margin-top:0px; margin-bottom:5px; display:block">
				          <a href="javascript:void(0)" class="{% if not user.customer_id %} student-request-accept-btn-credit {% else %} student-request-accept-btn {% endif %}"id="{{n.a_id_name}}-next-link">
				            <div class="btn-save">
				              {% if not user.customer_id %}
									<p id="student-accept-text"> NEXT STEP</p>
							  {% else %}
									<p id="student-accept-text"> CHOOSE THIS GURU</p>
							  {% endif %}
				            </div>
				          </a>
				        </div>
				    </div>
			        {% elif n.request_tutor_amount_hourly %}
			        {% endif %}
			        <div style="margin-top:25px;text-align:center; color:grey">
			        	Have questions? <a href="http://tinyurl.com/uguru-q-a" target="_blank"><u> Check out our FAQ</u></a>
			         </div>
	  			</div> -->
			{% elif n.custom_tag == 'tutor-request-offer' %}
				{{notification_details_template(user, n, request_dict, time, loop.index, None, None, user_avg_rating)}}
			<!-- {% set student_name = n.feed_message.split(" ")[0] %}
				<div id="{{n.a_id_name}}-detailed" style="display:none;">
					<div class="page-title">
	   					<div class="row-fluid" style="width:100%;text-align:center">
		   					<div class="col-xs-1 col-xs-offset-1 col-sm-offset-1 col-sm-1 col-md-offset-1 col-md-1">
			   					<a href="javascript:void(0)" class= "feed-message-link" style="text-decoration:none"> 
			   						<h4 id="back-button"><span style="color:white" class="glyphicon glyphicon-chevron-left"></span> </h4>
			   					</a>
		   					</div>
		   					<div class="col-xs-8 col-sm-8 col-md-8" style="text-align:center">
	   							<h4 style="color:white;width:100%">TUTORING REQUEST</h4>
	   						</div>
	   					</div>
	  				</div>
	  				<div id="credit-card-added-alert" style="display:none" class="row-fluid">
						  	<div style="margin:auto; float:center; margin-top:10px;"class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
							  	<div class="alert alert-success" style="margin-bottom:0px;">
							  		Credit card successfully added!
							  	</div>
							 </div>
					</div>
					{% if n.custom == 'tutor-accept-request' and not (request_dict[n.request_id]['request'].connected_tutor_id == request_dict[n.request_id]['student'].id) and not(request_dict[n.request_id]['request'].connected_tutor_id and request_dict[n.request_id]['request'].connected_tutor_id != user.id)%}
						<div class="row-fluid">
						  	<div style="margin:auto; text-align:center; float:center; margin-top:10px;"class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
							  	<div class="alert alert-info" style="margin-bottom:0px;">
							  		We have let the student know that you have accepted! <br>If the student chooses you, we will email you.
							  	</div>
							</div>
						</div>
					{% endif %}
					{% if request_dict[n.request_id]['request'].connected_tutor_id == request_dict[n.request_id]['student'].id %}
					<div class="row-fluid">
						  	<div style="margin:auto; text-align:center; float:center; margin-top:10px;"class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
							  	<div class="alert alert-danger" style="margin-bottom:0px;">
							  		Sorry! This request is no longer available
							  	</div>
							</div>
						</div>
					{% elif request_dict[n.request_id]['request'].connected_tutor_id and request_dict[n.request_id]['request'].connected_tutor_id != user.id %}
					<div class="row-fluid">
						  	<div style="margin:auto; text-align:center; float:center; margin-top:10px;"class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
							  	<div class="alert alert-danger" style="margin-bottom:0px;">
							  		Sorry! Another tutor has taken this offer.
							  	</div>
							</div>
						</div>
					{% endif %}
					{% if n.custom == 'tutor-is-matched' %}
					<br>
					<div class="row">
						<div class="next-steps-border col-xs-12 col-sm-offset-2 col-sm-8 col-md-4 col-md-offset-4">
							<div id="flakers-fee-alert" style="margin-bottom:15px; text-align:center; font-size:24px; ">
									<b>NEXT STEPS</b>
							</div>
							<div style="font-size:14px; font-weight:normal; text-align:left;">
								<p>
								1. Message your student, and finalize meetup <b>time & location</b>
								</p>
								<p>
								2. At end of the session, you will draft a bill by clicking <b>“BILL A STUDENT”</b> on your feed page.</p>
								<p>3. Have your student verify the amount, and input his/her <b>secret payment code</b> as proof of approval. </p>
								<p>The amount will be added to your balance, and you can cash out at any time! (Never have to worry about dealing with change, or students that "forgot to bring cash")</p>
							</div>
						</div> 
						<div id="launch-profile-div" class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-offset-4 col-md-4" style="padding-left:0px; padding-right:0px; margin-top:20px; margin-bottom:20px; display:block">
				          <a id="launch-profile-link" href="/messages/">
				            <div class="btn-save">
				              <p>MESSAGE STUDENT NOW
				              </p>
				            </div>
				          </a>
				        </div>
				        
				    </div>
				    <div class="row">
						<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-4 col-md-offset-4" style="margin-bottom:-20px; margin-top:20px">
						    <div id="flakers-fee-alert" style="text-align:center; font-size:16px; color:grey;">
									<i><b>REQUEST INFO</b></i>
							</div>
						</div>
					</div>
					{% endif %}
					<div class="row">
					<div class="container-fluid" align="center" style="margin-left:20px;margin-right:20px">
					  	<br>
					  	{% if request_dict[n.request_id]['student'].profile_url %}
					  	<img src="{{request_dict[n.request_id]['student'].profile_url}}" style="align:center" class="user-photo">
					  	{% else %}
					  	<img src="/static/img/default-photo.jpg" style="align:center" class="user-photo">
					  	{% endif %}
					  <h5 style="text-align:center">{{n.feed_message|safe}}</h5>
					  <div class="row">
						  <div class="request-info col-xs-12 col-sm-offset-2 col-sm-8 col-md-6 col-md-offset-3">
							  	<div class="row">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Estimated Session Time</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><span id="student-time-estimate-{{loop.index}}"> {{request_dict[n.request_id]['request'].time_estimate}}</span> hours
							  			</div>
							  		</div>
							  	</div>
							  	<div class="row">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Details</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].description}}</span> 
							  			</div>
							  		</div>
							  	</div>
							  	<div class="row">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Availability</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"></span> 
							  				{% if request_dict[n.request_id]['student-calendar'] %}
								  				{% if n.custom == 'tutor-accept-request' and not request_dict[n.request_id]['request'].connected_tutor_id == request_dict[n.request_id]['student'].id%}
						                        <span class='red-text'> See chosen time: </span> 
					                              <a id='request-calendar-toggle' onclick='show_tutor_request_submitted_calendar({{request_dict[n.request_id]["student-calendar"]}}, {{request_dict[n.request_id]["tutor-calendars"][user.id]}}, false, {{time.mktime(request_dict[n.request_id]["request"].time_created.timetuple())}})'>
					                                <span class='glyphicon glyphicon-calendar'></span>
					                              </a>
						                        {% else %}
						                        <span class='red-text'> Select a time: </span> 
					                              <a id='request-calendar-toggle' onclick='show_tutor_request_calendar({{request_dict[n.request_id]["student-calendar"]}},{{request_dict[n.request_id]["request"].time_estimate}}, {{time.mktime(request_dict[n.request_id]["request"].time_created.timetuple())}})'>
					                                <span class='glyphicon glyphicon-calendar'></span>
					                              </a>
						                        {% endif %}
						                    {% else %}
						                    	{{request_dict[n.request_id]['request'].availability}}
						                    {% endif %}
							  			</div>
							  		</div>
							  	</div>
							  	<div class="row">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row"><b>Preferred Location</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4 request-info-row">{{request_dict[n.request_id]['request'].location}}</span> 
							  			</div>
							  		</div>
							  	</div>
							  	{% if request_dict[n.request_id]['request'].professor %}
							  	<div class="row">
							  		<div class="request-info-left-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4"><b>Professor</b></div>
							  		</div>
							  		<div class="request-info-right-column col-xs-6 col-sm-6 col-md-6">
							  			<div class="h4">{{request_dict[n.request_id]['request'].professor}}</span> 
							  			</div>
							  		</div>
							  	</div>
							  	{% endif %}
							  	{% if request_dict[n.request_id]['request'].last_updated %}
							  	<div style="text-align:center;color:red" class="row">
							  		<i>The student has recently updated this request.</i>
							  	</div>
							  	{% endif %}	
							  </div>
							</div>
								<div style="text-align:center; margin-top:10px; color:grey">
									{% if n.custom != 'tutor-reject' and not (request_dict[n.request_id]['request'].connected_tutor_id and request_dict[n.request_id]['request'].connected_tutor_id != user.id) %}
									<i><span id="request-student-offer-index-{{loop.index}}">
										{% if not ((n.custom == 'tutor-accept-request' or n.custom=='tutor-is-matched') and (prices_dict[request_dict[n.request_id]['request'].student_estimated_hour]|float) != n.request_tutor_amount_hourly) %}
										The student is offering: 
										{% else %}
										The student will pay:
										{% endif %}

									</span></i><br>
									{% else %}
									<i>You could have made:</i> <br>
									{% endif %}
									<div>
										<span style="color:#69bf69; font-size:45px;"><strong> $<span id="student-offer-total-price-{{loop.index}}">{% if not n.request_tutor_amount_hourly %}{{(request_dict[n.request_id]['request'].time_estimate * request_dict[n.request_id]['request'].student_estimated_hour)}}
											{% else %}{{(request_dict[n.request_id]['request'].time_estimate * n.request_tutor_amount_hourly)}}{% endif %}
										</span></strong></span>
									</div>
									<div style="margin-top:-5px;">
										<span style="color:grey; font-weight:100; font-size:16px">
											($<span id="student-offer-hourly-price-{{loop.index}}">{% if not n.request_tutor_amount_hourly %}{{(request_dict[n.request_id]['request'].student_estimated_hour)}}{% else %}{{(n.request_tutor_amount_hourly)}}{% endif %}</span>/hr x {{request_dict[n.request_id]['request'].time_estimate}}hr)
										</span>
									</div>
									{% if (n.custom == 'tutor-accept-request' or n.custom=='tutor-is-matched') and (request_dict[n.request_id]['request'].student_estimated_hour|float) != n.request_tutor_amount_hourly %}
									<div style="font-size:14px; margin-top:3px; color:grey">
											You changed the original price the student will pay from ${{(request_dict[n.request_id]['request'].student_estimated_hour)}}/hr to ${{(n.request_tutor_amount_hourly)}}/hr 
									</div>
									{% endif%}
									{% if n.custom == 'tutor-accept-request' and not request_dict[n.request_id]['request'].connected_tutor_id == request_dict[n.request_id]['student'].id%}
									<div class="row" style="margin-top:10px;color:red">
										<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
											If the student accepts, you will make $<span id="tutor-will-pay-{{loop.index}}">{{prices_dict[n.request_tutor_amount_hourly]}}</span>/hr for your first session after one-time connection fees. <br>You will make ${{(n.request_tutor_amount_hourly)}}/hr for each following session.
										</div>
									</div>
									<div style="font-size:10px; margin-top:10px; color:grey">
										Can't commit anymore? Cancel <a href="javascript:void(0)" class="tutor-cancel-accept">here </a>
									</div>
									{% endif %}
								</div>
								{% if n.custom != 'tutor-reject' and n.custom != 'tutor-accept-request' and n.custom != 'tutor-is-matched' and not (request_dict[n.request_id]['request'].connected_tutor_id and request_dict[n.request_id]['request'].connected_tutor_id != user.id) %}
								<a style="text-align:center;" id="tutor-change-price-link-{{loop.index}}" class="tutor-change-price-link" href="javascript:void(0);">
									<div style="margin-top:0px;color:rgb(0, 159, 225)"> Change the price
									</div>
								</a>
								{% endif %}
						 	</div>
						 </div>
				    <br>
				    {% if n.custom != 'tutor-reject' and n.custom != 'tutor-accept-request' and n.custom != 'tutor-is-matched' and not (request_dict[n.request_id]['request'].connected_tutor_id and request_dict[n.request_id]['request'].connected_tutor_id != user.id)%}
				    <div class="row" style="display:none; text-align:center; margin-top:-10px; margin-bottom:30px" id="tutor-change-price-slider-div-{{loop.index}}">
				    	<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-6 col-md-offset-3">
				    		<div style="margin:auto; width:75%" id="tutor-change-price-slider-{{loop.index}}" class="tutor-change-price-slider"></div>
				    	</div>
				    	<br>
				    	<a style="text-align:center;" class="tutor-change-price-cancel" id="tutor-change-price-cancel-{{loop.index}}" href="javascript:void(0);">
									<div style="margin-top:10px;color:rgb(0, 159, 225)"> Cancel
									</div>
						</a>
				    </div>
				    <div class="row" style="text-align:center; margin-bottom:10px; color:#CD2626">
				    	You will make $<span id="tutor-will-pay-{{loop.index}}">{{prices_dict[(request_dict[n.request_id]['request'].student_estimated_hour)]}}</span>/hr for your first session with {{student_name|safe}} after one-time connection fees 
				    	<span id="student-has-agreed-{{loop.index}}"style="color:grey">
				    	 <br>
				    	 {{student_name|safe}} has agreed to pay you ${{(request_dict[n.request_id]['request'].student_estimated_hour)}}/hr after your first session.
				    	</span>
				    </div>
				    <div class="row">
						<div id="launch-profile-div" class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-offset-4 col-md-4" style="padding-left:0px; padding-right:0px; margin-top:0px; margin-bottom:5px; display:block">
				          <a data-toggle="modal" data-target="#modal-{{n.a_id_name}}" href="#">
				            <div class="btn-save">
									<p id="student-accept-text"> ACCEPT REQUEST</p>
				            </div>
				          </a>
				        </div>
				     </div>
				     <div class="modal fade modal-extra-detail" id="modal-{{n.a_id_name}}"tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
					  <div style="margin:10% auto"class="modal-dialog modal-lg">
					    <div class="modal-content">
					      <div class="modal-header">
					        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					        <h4 style="text-align:center"class="modal-title" id="myModalLabel">PERSONALIZE YOUR RESPONSE TO {{n.feed_message.split(" ")[0]|upper|safe}}</h4>
					      </div>
					      <div style="color:grey; text-align:center" class="modal-body cancel-request">
					        <h4 style="color:grey">
					        	Stand out from other Gurus by covering details like: 
					        </h4>
					        <div class="row">
					        	<div style="text-align:left; font-size:12px;" class="col-xs-12 col-sm-offset-4 col-sm-4 col-md-offset-3 col-md-6">
				        			<div style="margin-left:15%">
				        				<ul>
				        					<li>
				        						Your response to the student's "additional details"
				        					</li>
				        					<li>
												Your experience with this subject
					        				</li>
					        				<li>
												Studying resources that you can provide
					        				</li>
					        			</ul>
				        			</div>
					        	</div>
					        </div>
					        <div class="row">
					        	<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-2 col-md-8">
					        		<h6 style="color:black; margin-bottom:0px;"><u>Additional Details from {{n.feed_message.split(" ")[0]|upper|safe}}</u><br>
					        		</h6>
					        		<h5 style="margin-top:5px;color:grey;">{{request_dict[n.request_id]['request'].description}}</h5>
					        	</div>
					        </div>
					        <div class="row extra-detail">
						        <div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-2 col-md-8">
					        		<textarea onclick="this.focus();this.select()" class="bio"></textarea>
					        	</div>
					        </div>
					        <div class="row extra-detail-alert" style="display:none; text-align:center; font-size:12px;color:red;">
						    	Please do not include personal contact information in your response. <br> You can exchange this after the student has selected you!
						    </div>
					      </div>
					      <div class="modal-footer">
					        <div class="row">
						        <div id="launch-profile-div" class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-offset-4 col-md-4" style="padding-left:0px; padding-right:0px; display:block">
						          <a class="tutor-request-accept-btn" href="javascript:void(0)">
						            <div class="btn-save">
						              <p>ACCEPT REQUEST
						              </p>
						            </div>
						          </a>
						        </div>
						    </div>
					        <div class="row" style="text-align:center; font-size:12px; margin-top:3px;color:grey;">
					        	If you click accept, you agree to our <strong> <a href="/tos/">Terms of Service</a> </strong> and <strong> to be paid through Uguru </strong>
					        </div>
					      </div>
					    </div>
					  </div>
					</div>
					 <div>
					     <div style="text-align:center; color:grey">
				        	<i>or ignore this request if you're not interested.</i>
				         </div>
				     </div>
					{% endif %}
					<div style="margin-top:25px;text-align:center; color:grey">
			        	Have questions? <a href="http://tinyurl.com/uguru-q-a" target="_blank"><u> Check out our FAQ</u></a>
			         </div>
				</div> -->
			{% endif %}
		{% endfor %}
	</div>
</div>

	

{% endblock %}

{% block footer_scripts %}
	<script src="/static/js/modernizr.js"></script>
	<script type="text/javascript">
	window.onload = function() {

		var Modernizr = window.Modernizr;
		
		if(Modernizr.csstransforms3d) { 
			
			var head = document.querySelector('head');
			
			head.innerHTML = head.innerHTML + '<link rel="stylesheet" href="/static/css/inserthtml.com.radios.min.css" />';
			
		}
	}
	</script>

	<script src="/static/js/jquery-ui-custom.js"></script>
	<script type="text/javascript" src="/static/js/typeahead.js"></script>
	<script src="/static/js/activity.js"></script>    
	{% if not user.customer_id or user.balance > 0%}
	<script type="text/javascript" src="https://js.stripe.com/v2/"></script>
	<script src="/static/js/jquery.payment.js"></script>
	<script src="/static/js/uguru.payments.js"></script>    
	<script type="text/javascript">Stripe.setPublishableKey("{{key}}");</script>
	{% endif %}
	<script type="text/javascript" src="/static/js/jquery-ui.js"></script>
	<script src="/static/js/jquery.nouislider.new.min.js"></script>
	<script>
        var Link = $.noUiSlider.Link; 
        {% if confirm_payments %}
        $('#confirm-time-payment-slider').slider(
          {
            'min':1, 
            'max':20, 
            'value':{{confirm_payments[0]['payment'].time_amount}} * 2,
            change: function(event, ui) {
              slider_val = $(this).slider('value');
              hr_text = 'hrs'
              if (slider_val == 2) {
                hr_text = 'hr'
              }
		      $('#change-payment-time-txt').text((slider_val/2) + hr_text);
		      hourly_rate = parseInt($('#confirm-payment-tutor-rate').text())
		      $('#confirm-payment-tutor-total').text(((slider_val/2) * hourly_rate * 0.75).toFixed(2));
            }
          }
      	);
      	$('#edit-confirm-payment-link').click(function() {
	      $(this).hide();
	      $('#edit-confirm-payment-cancel').show();
	      orig_estimated_hour = $('#confirm-time-payment-slider').slider('value');
	      $('#change-time-container').show();
	      $('#submit-confirm-payment-text').text('Adjust Amount and Bill');
	    });

	    $('#edit-confirm-payment-cancel').click(function() {
	      $(this).hide();
	      $('#change-time-container').hide();
	      $('#edit-confirm-payment-link').show();
	      $('#submit-confirm-payment-text').text('This Looks Right');
	    });
        {% endif %}

        {% if user.verified_tutor %}

        $('.tutor-change-price-slider').slider(
          {
            'min':5, 
            'max':40, 
            'value':15,
            change: function(event, ui) {
              slider_val = $(this).slider('value');
              hr_text = 'hrs'
              if (slider_val == 1) {
                hr_text = 'hr'
              }
              feed_message_index = last_clicked_notif_index + 1
		      $('#student-offer-hourly-price-' + feed_message_index).text($('#tutor-change-price-slider-'+ feed_message_index).slider('value'));
		      $('#student-offer-total-price-' + feed_message_index).text($('#tutor-change-price-slider-'+ feed_message_index).slider('value') * $('#student-time-estimate-' +feed_message_index).text());
		      $('#you-will-make-' + feed_message_index).text(parseFloat($('#tutor-change-price-slider-'+ feed_message_index).slider('value')) * 0.75 *parseFloat($('#session-length-'+ feed_message_index).text()));
            }
          }
      	);
        {% endif %}
        {% if address_book or user.verified_tutor %}
        $('#time-estimate-slider-payment').slider(
          {
            'min':0, 
            'max':10, 
            'value':2,
            change: function(event, ui) {
              slider_val = $(this).slider('value');
              $('#payment').text(slider_val)
            }
          }
      	);

        $('#hourly-price-slider-payment').slider(
          {
            'min':10, 
            'max':40, 
            'value':15,
            change: function(event, ui) {
              slider_val = $(this).slider('value');
              $('#student-charged-payment').text(prices_reversed_dict[parseInt($('#hourly-price-slider-payment').slider('value'))] + "")
              $('#price').text(slider_val);
            }
          }
      	);

        $("#hourly-price-slider-payment").noUiSlider({
            start:15
           	,range: {'min':[10], 'max':[40]}
           	,step: 1
           	,serialization: {
                lower: [ new Link (
                  {
                    target: $('#price')
                  })
                ],
                format: {
                  decimals:1
                }
              }
        });
        {% endif %}
        {% for r in user.outgoing_requests %}
        	$("#hourly-price-slider-request-{{loop.index - 1}}").noUiSlider({
	            start:{{r.student_estimated_hour}}
	           	,range: {'min':[12], 'max':[40]}
	           	,step: 1
	           	,serialization: {
	                lower: [ new Link (
	                  {
	                    target: $('#hourly-price-request-{{loop.index - 1}}')
	                  })
	                ],
	                format: {
	                  decimals:0
	                }
	              }
        	});
        	$("#time-estimate-slider-request-{{loop.index - 1}}").noUiSlider({
	            start:{{r.time_estimate}}
	           	,range: {'min':[0], 'max':[6]}
	           	,step: 0.5
	           	,serialization: {
	                lower: [ new Link (
	                  {
	                    target: $('#time-estimate-request-{{loop.index - 1}}')
	                  })
	                ],
	                format: {
	                  decimals:1
	                }
	              }
        	});
        {% endfor %}
    </script>
{% endblock %}