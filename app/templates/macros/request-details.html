{% macro request_details(user, notif, request_dict, time, index) -%}                        
{% set student_name = notif.feed_message.split(" ")[3] %}
    <div class='request-details-attribute-container margin-top-30 margin-bottom-15 block'>
        <img id='request-details-photo' src='{{user.profile_url}}' height='100px'> 
        <div class='guru-profile-attributes'> 
            <div class='row'>
                <span id='profile-name' class="{% if notif.custom == 'tutor-is-matched' %} font-18 {% else %} font-20 {% endif %}">
                    {{notif.feed_message|safe}} 
                </span>
            </div>
            <div class='row font-14 margin-top-10 reg-text'>
                Professor: 
                <span class='green-text'> {{request_dict[notif.request_id]['request'].professor}}
                </span>
            </div>
            <div class='row font-14 margin-top-10 reg-text'>
                Preferred Meeting Location: 
                <span class='green-text'> {{request_dict[notif.request_id]['request'].location}}
                </span>
            </div>
            <div class='row font-14 margin-top-10 reg-text'>
                This Session Would Take: 
                <span class='green-text'> {{request_dict[notif.request_id]['request'].time_estimate}} hours
                </span>
            </div>

            {% if notif.custom_tag == 'student-request-help' %}
            <div class='row font-14 margin-top-10 reg-text'>
                Meeting Time:
                <span class='green-text'> 
                    {% if request_dict[notif.request_id]['student-calendar'] %}
                        <span class='green-text'> See times: </span> 

                        <a id='request-calendar-toggle' onclick='show_student_request_calendar({{request_dict[notif.request_id]["student-calendar"]}}, {{time.mktime(request_dict[notif.request_id]["request"].time_created.timetuple())}})'>
                            <span class='glyphicon glyphicon-calendar'></span>
                        </a>
                    {% else %}
                        
                        {{request_dict[notif.request_id]['request'].availability}}

                    {% endif %}
                </span>
            </div>
            {% endif %}

            {% if notif.custom_tag == 'tutor-request-offer' %}
                <div class='row font-14 margin-top-10 red-text'>
                    {% if notif.custom == 'tutor-accept-request' and not request_dict[notif.request_id]['request'].connected_tutor_id == request_dict[notif.request_id]['student'].id%}
                      <a id='request-calendar-toggle' onclick='show_tutor_request_submitted_calendar({{request_dict[notif.request_id]["student-calendar"]}}, {{request_dict[notif.request_id]["tutor-calendars"][user.id]}}, false, {{time.mktime(request_dict[notif.request_id]["request"].time_created.timetuple())}})'>
                        <span class='red-text'> See chosen time: </span> 
                        <span class='glyphicon glyphicon-calendar'></span>
                      </a>
                    {% else %}
                      <a id='request-calendar-toggle' onclick='show_tutor_request_calendar({{request_dict[notif.request_id]["student-calendar"]}},{{request_dict[notif.request_id]["request"].time_estimate}}, {{time.mktime(request_dict[notif.request_id]["request"].time_created.timetuple())}})'>
                        <span class='red-text'> See Student Availability and Choose A Time: </span> 
                        <span class='glyphicon glyphicon-calendar'></span>
                      </a>
                    {% endif %}
                </div>
            {% endif %}
            
            <div class='row font-14 margin-top-10 reg-text'>
                Hourly Rate:
                <span class='green-text'> $<span id='student-offer-hourly-price-{{index}}'>{{request_dict[notif.request_id]['request'].student_estimated_hour}}</span>/hr
                </span> 
                
                {% if notif.custom_tag == 'tutor-request-offer' %}
                &nbsp;&nbsp;&nbsp;
                <a id="tutor-change-price-link-{{index}}" class="tutor-change-price-link" href="javascript:void(0);">
                    <span class='glyphicon glyphicon-pencil blue-text'> </span>
                </a>
                <a class="tutor-change-price-cancel" style='display:none' id="tutor-change-price-cancel-{{index}}" href="javascript:void(0);">
                    <span class='glyphicon glyphicon-remove blue-text float-right'> </span>
                </a>
                <br>
                <div style="display:none; width:100%" id="tutor-change-price-slider-div-{{index}}">
                        <div style="margin:auto;" id="tutor-change-price-slider-{{index}}" class="tutor-change-price-slider"></div>
                </div>

                {% endif %}

            </div>
        </div>
    </div>
    <div class='row block margin-top-10' style='padding-left:16px'>
        <label class='font-20'> Additional Details </label>
        <div id='guru-intro' class='block font-14'>
            {{request_dict[notif.request_id]['request'].description}}
        </div>
        <br>
    </div>

    {% if notif.custom_tag == 'student-request-help' %}
        <div class='row block margin-top-10' style='padding-left:16px'>
            <label class='font-20'> Contacted Tutors ({{request_dict[notif.request_id]['request'].requested_tutors|length}}) </label>
            <div id="contacted-tutors">
                {% for tutor in request_dict[notif.request_id]['request'].requested_tutors %}
                <span>
                    <img src="{{tutor.profile_url}}" style="align:center" class="tutor-photo"> 
                </span>
                {% endfor %}
            </div>
            <br>
        </div>
    {% endif %}

    <hr style='color:grey; margin-top:10px'>

    {% if notif.custom_tag == 'tutor-request-offer' and not notif.custom == 'tutor-is-matched' %}
    <div class='row block margin-top-10 margin-bottom-20' style='padding-left:16px'>
        <label class='font-20'> Your Personal Message To {{student_name|safe}} </label>
        <div class='font-14 block margin-bottom-15'>
            Include a message to address {{student_name}}'s request and market yourself!
        </div>
        <textarea class='form-control standard-textarea guru-request-reply-textarea'></textarea>
        <div class='row-fluid font-20 margin-top-40 margin-bottom-20 center'>
            <div class='center red-text font-12 extra-detail-alert'  style='display:none'>
            </div>
            <br>
            <a href='javascript:void(0);' class='tutor-request-accept-btn'>
                <span class='blue-btn' style='padding:8px 60px'> Accept This Offer </span>
            </a>
        </div>
    </div>
    {% endif %}

    {% if notif.custom_tag == 'student-request-help' %}
    <div class='row center font-12'>
        Can't make it anymore? Just <a class="cancel-request blue-text" href="javascript:void(0)"> cancel </a>
    </div>
    {% endif %}

    {% if notif.custom ==  'tutor-is-matched' %}
    <div class='row-fluid margin-top-20 block' style='background-color:#E0EEE0'>
        <label class='font-20 green-text'> Next Steps </label>
        <div id='guru-intro' class='block font-14'>
            <p> 1. Message your student to confirm meeting time and location. </p>
            <p> 2. No need to ask for cash, you will get paid through Uguru. </p>
        </div>
        <br>
    </div>

    <div class='row-fluid font-20 margin-top-40 margin-bottom-20 center'>
        <a href="/messages/" >
            <span class='blue-btn' style='padding:8px 60px'> Message Your Student </span>
        </a>
    </div>

    {% endif %}

{%- endmacro %}