{% extends 'admin/base.html' %}

{% block header_scripts %}
<link href="/static/admin/plugins/ionslider/ion.rangeSlider.css" rel="stylesheet" type="text/css" />
    <!-- ion slider Nice -->
    <link href="/static/admin/plugins/ionslider/ion.rangeSlider.skinNice.css" rel="stylesheet" type="text/css" />
    <link href="/static/admin/plugins/datepicker/datepicker3.css" rel="stylesheet" type="text/css" />
    <link href="/static/admin/plugins/timepicker/bootstrap-timepicker.min.css" rel="stylesheet"/>
{% endblock %}

{% block content %}
 <!-- Content Wrapper. Contains page content -->

      <div class="content-wrapper" style="min-height: 918px;">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <h1>
            {{university.name}}
            <small>All of the best flickr photos</small>
          </h1>
          <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-bar-chart-o"></i> Home</a></li>
            <li>Design</li>
            <li class="active">Flickr</li>
          </ol>
        </section>


        <section class="content">


          <div class="row">
            <div class="col-lg-12 col-md-12 col-xs-12">
              <!-- small box -->
              <div class="small-box bg-aqua">
                <div class="inner">
                  <h3>{{flickr_photos|length}}</h3>
                  <p>for {{university.name}}</p>
                </div>
                <div class="icon">
                  <i class="ion ion-document"></i>
                </div>
              </div>
            </div><!-- ./col -->
          </div>

          <!-- <div class='row'>
            <div class='col-md-12'>
              <div class="box box-info" style='padding-left:2%;'>
                {% for photo in flickr_photos %}
                <div class='row'>
                  <img src='{{photo["url"]}}'/>
                </div>
                {% endfor %}
              </div>
            </div>
          </div> -->
          <div class="row">
            {% for photo in flickr_photos %}
            <div class="col-md-6">
              <div class="box box-solid" style='max-height:350px'>
                <div class="box-header with-border">
                  <h3 class="box-title">{{photo['title']}}</h3>
                  <div class="box-tools pull-right">
                    <a onclick='saveUniversityPhotoToDatabase({{university.id}}, "{{photo["url"]|string}}")' id='university-save-icon'>
                    <i style='font-size:150%;' class="ion ion-android-download"></i></a> &nbsp;&nbsp;
                    <span data-toggle="tooltip" style='font-size:125%; margin-bottom:-5px;' title="" class="badge bg-light-blue" data-original-title="3 New Messages"><i style='font-size:100%;' class="ion ion-eye"></i>&nbsp;&nbsp;{{photo['views']}}</span>
                  </div>
                </div><!-- /.box-header -->

                <div class="box-body">
                  <img style='width:100%; height:80%;' src='{{photo["url"]}}'/>
                </div><!-- /.box-body -->
              </div><!-- /.box -->
            </div><!-- /.col (left) -->
            {% endfor %}
          </div>

        </section>

      </div>

{% endblock %}

{% block footer_scripts %}
<script src="/static/admin/plugins/ionslider/ion.rangeSlider.min.js" type="text/javascript"></script>
<script src="/static/admin/plugins/ionslider/ion.rangeSlider.min.js" type="text/javascript"></script>
<script src="/static/admin/plugins/datepicker/bootstrap-datepicker.js" type="text/javascript"></script>
<script src="/static/admin/plugins/timepicker/bootstrap-timepicker.js" type="text/javascript"></script>
<script src="/static/js/admin/mandrill.js" type="text/javascript"></script>
<script>
  var saveUniversityPhotoToDatabase = function(university_id , university_src) {
    if (confirm('Set this as the main banner photo for this universitiy?')) {
      BASE_URL = "http://uguru.me/api/admin/";
      auth_token = "9c1185a5c5e9fc54612808977ee8f548b2258d31";
      $.ajax({
        url: BASE_URL + auth_token + "/universities/" +  university_id.toString(),
        method: 'PUT',
        dataType: 'json',
        contentType:'application/json',
        data: JSON.stringify({'university_banner': university_src}),
        success: function(resp){
          alert("Success!");
        },
        error: function(err){
          alert("Error tell Samir!");
          console.log(err);
        }
      });
    }
  }
</script>

{% endblock %}