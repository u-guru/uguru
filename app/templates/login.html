{% extends 'base.html' %}
{% block header %}
{% endblock %}

{% block content %}
  <div class="login-modal">            
      <div class="row vertical-offset-100">
        <div class="col-md-4 col-md-offset-4">
          <div class="panel panel-default">
            <div class="panel-heading">
              <button type="button" class="close" id="modal-close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h2>Log In</h2>
            </div>
            <div class="panel-body">
              <div>
                  <span id='alert-fields-login' style="color:red;display:None">Incorrect username or password</span>
                  {% if redirect %}
                  <span id='alert-fields-login-redirect' style="color:red;text-align:center">Please Login First</span>
                  {% endif %}
              </div>
              <form accept-charset="UTF-8" role="form">
              <fieldset>
                <div class="form-group">
                    <input id="login-email" name="login-email" class="form-control" placeholder="E-mail" name="email" type="text">
                </div>
                <div class="form-group">
                  <input id="login-password" name="login-password" class="form-control" placeholder="Password" name="password" type="password" value="">
                </div>
                 <a href="javascript:void(0)" id="login-submit" class="btn btn-lg push_button_default btn-block" type="submit">Submit</a>
              </fieldset>
              </form>
            </div>
          </div>
      </div>
    </div>
  </div>

{% endblock %}

{% block footer_scripts %}
<script>
$('#login-submit').click(function(){
    //check whether fields are blank
    if (!$('#login-email').val() || !$('#login-password')) {
      $('#alert-fields-student-signup2').show()
    } else {
      //else get data and send to server
      var data = {
        'email': $('input[name="login-email"]').val(),
        'password': $('input[name="login-password"]').val()
      }
      $.ajax({
        type: "POST",
        contentType: 'application/json;charset=UTF-8',
        url: '/login/' + '?' + '{{redirect}}'.replace('amp;', '').replace('amp;',''),
        data: JSON.stringify(data),
        dataType: "json",        
        success: function(result) {        
          if (result.json['success']) {
            window.location.replace(result.json['redirect'])
          } else {
            $('#alert-fields-login').show();     
            $('#alert-fields-login-redirect').hide();
          }
        }
      });      
    }
  });
</script>
{% endblock %}

