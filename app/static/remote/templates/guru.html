<ion-view hide-nav-bar='true' class='request' id='guru-home'>

  <ion-header-bar align-title="center" class='dark-bg-header item-icon-right'>
      <h1 class="title">Tasks</h1>
        <div class="buttons" ng-show='user.balance && user.balance > 0'>
          <a ng-click='goToCashOut()'>
            <i class='icon bold green font-1em'>
              ${{user.balance}}
            </i>
          </a>
        </div>
  </ion-header-bar>

<div class="tabs home-request-tabs-top tabs-top">

      <a class="tab-item uppercase ng-class:{'blue-bg white-text':showActive, 'opacity-1-2':!showActive}" ng-click='showPreviousActions(0);'>
        Your Tasks
      </a>
      <a class="tab-item uppercase ng-class:{'blue-bg white-text':!showActive, 'opacity-1-2':showActive}" ng-click='showPreviousActions(1);'>
        Previous
      </a>
</div>


<ion-content class='white-bg has-subheader dirty-white-bg' scroll='false'>

    <!-- the initial i have no tasks screen -->
    <div class='pure-g-c flex-column flex-space-between' ng-hide='((user.pending_proposals && user.pending_proposals.length > 0)) || !showActive || (user.active_guru_sessions && user.active_guru_sessions.length > 0)' style='padding-bottom:55px;' >
        <div class='pure-g j-start relative' style='min-height:180px; height:180px;'>
          <div class='profile-banner-bg full-height'  style='background-image:url({{img_base}}./img/guru/university-banner.png); min-height:180px; height:180px;'>
          </div>
            <div class='pure-g-c flex-column j-start guru-profile-img-wrapper full-width relative' style='height:50%;top:0%; opacity:1; min-height:180px;'>
              <div class='pure-g'>
                <div class='pure-u-1 padding-2em' style='padding-top:0.75em; z-index:1000; opacity-1'>

                  <div class='grey-container center'>
                    <h4 class='light capitalized university-banner-text' style='margin-top:5px;'>  <span class='padding-half'>UC Berkeley Guru Rank </span></h4>
                  </div>
                </div>
              </div>
            </div>
            <div class='pure-g-c flex-column j-start full-width relative' style='height:50%; top:50%; z-index:100;'>
              <div class='pure-g'>
                <div class='pure-u-1 center'>
                  <div class='pure-u-1-2 relative margin-auto relative'>
                    <div class='guru-ranking-progress-container full-width' style='position:absolute;'>
                      <div id='guru-ranking-progress' class='padding-1em relative'>
                      </div>
                    </div>
                    <!-- <div class='ranking-container auto-margin full-width relative' style='position:absolute;'>
                      <span class='light absolute text'>
                        <span class='font-400'>9</span><span class='micro-text uppercase semibold'>th</span>
                      </span>

                    </div> -->
                  </div>
                </div>
              </div>

              <div class='pure-g'>
                <div class='pure-u-1-3 ranking-box'>

                    <div class='grey-container center padding-half' style='width:105%;'>
                      <h6 class='light uppercase no-margin semibold'>  <div class='dark-bg bold padding-half opacity-4-5'>Rank</div></h6>
                      <h4 class='light capitalized no-margin no-padding'>  <div class='ranking-num'>131</div></h4>
                    </div>

                </div>
                <div class='pure-u-1-3 relative'>
                  &nbsp;
                </div>
                <div class='pure-u-1-3 payscale-box'>
                  <div class='grey-container center padding-half' style='width:105%;'>
                      <h6 class='light uppercase no-margin semibold'>  <div class='dark-bg bold opacity-4-5 padding-half'>Payscale</div></h6>
                      <h4 class='light capitalized no-margin no-padding'>  <div class='ranking-num'>131</div></h4>
                    </div>
                </div>
              </div>
          </div>

        </div>
        <div class='pure-g flex-column flex-space-between'>


            <div class='flex-item-c pure-g center j-center'>
              <div class='container tip-of-day-container' style='padding:10% 0% 0% 0%'>
                <div class='pure-u-1 padding-1em'>
                  <h1 class='uppercase no-margin semibold opacity-3-5'> TIP OF DAY </h1>
                </div>

                <p class='opacity-3-5' style='padding:0em 3em;'> Become 5th percentile by adding a profile image, description, and verifying school email </p>
              </div>
            </div>
            <div class='flex-item-c pure-g center j-start'>
                <div class='pure-u-1 padding-half' style='padding-left:1em; padding-right:1em; margin-top:0.5em;'>
                  <a href='#/ranking' style='min-height:3.3em; line-height:3.3em;' nav-direction='forward' class='button button-full light-blue-bg button-footer white-text uppercase no-margin'>Edit Profile</a>
                </div>
                <div class='pure-u-1 item-icon-right' style='padding-left:1em; padding-right:1em;'>
                  <p class='opacity-1-2 grey-text normal no-margin'>
                    See all incentives
                  </p>

                </div>
            </div>
          </div>
        <!-- <ion-scroll>
        </ion-scroll> -->
      </div>
       <!--  <div class='flex-item-c j-end center'>

          <div class='ranking-text-container relative font-3em'>
            <img class='pure-img absolute ranking-img' src='{{img_base}}./img/ranking/ranking_80.svg'>
            <div class='ranking-text center relative'>
              <h1 class='sans-light ranking-text-header no-margin font-300'> {{user.estimated_guru_rank || 25}} </h1>
              <h6 class='uppercase letter-spacing-small semibold opacity-1-2 percentile-text'>Percentile</h6>
              <span class='absolute uppercase th-text'>th</span>
            </div>
          </div>
        </div>


        <div class='flex-item-c j-end center'>
          <div>
            <p class='center opacity-1-3 padding-1em'>
            You can improve your ranking and make <br>
            way more money by tutoring students, <br>
            answering questions, and finishing tasks.
            </p>
            <div class='pure-u-1' style='padding-left:1em; padding-right:1em;'>
              <a href='#/ranking' nav-direction='forward' class='button button-full light-blue-bg button-footer white-text uppercase'>Increase my ranking</a>
            </div>
          </div>
        </div> -->
    </div>
    <div class='pure-g-c flex-column flex-space-between' ng-show='!showActive'>


        <ion-scroll class='full-height'>

          <ion-refresher
            pulling-icon="ion-arrow-down-c"
            spinner="circles"
            on-refresh="doRefresh()">
          </ion-refresher>

            <div class='pure-g'>

               <ion-list class='pure-u-1' can-swipe="true">

                  <div class='active-request-card-item-wrapper' ng-repeat='proposal in user.previous_proposals'>
                    <ion-item class='item-avatar request-card-item'>
                      <img class='pure-img' ng-src='{{img_base}}./img/verbs/{{proposal.request.verb_image}}' />
                      <div class='request-card-content relative'>
                        <p class='course-text relative'>
                          <span ng-show='proposal.request._type === 0 || proposal.request._type === 1'>
                            {{proposal.request.course.short_name}}
                          </span>
                          <span ng-show='proposal.request._type === 2' class='transform-capitalize'>
                            {{proposal.request.task_title}}
                          </span>
                          <span class='request-tag-status request-tag-status-completed' ng-show='proposal.status === 4'> STUDENT CANCELED </span>
                          <span class='request-tag-status request-tag-status-completed' ng-show='proposal.status === 15'> Answered </span>
                          <span class='request-tag-status request-tag-status-completed' ng-show='proposal.status
                          === 5'> CANCELED </span>
                        </p>
                        <p class='location-text' ng-show='proposal.request._type !== 1'> {{proposal.request.address}}</p>
                      </div>
                    </ion-item>
                  </div>

                  <div class='active-request-card-item-wrapper' ng-repeat='session in user.previous_guru_sessions'>
                    <ion-item class='item-avatar request-card-item'>
                      <img class='pure-img' ng-src='{{img_base}}./img/verbs/{{session.request.verb_image}}' />
                      <div class='request-card-content relative'>
                        <p class='course-text relative'>
                          <span ng-show='session.request._type === 0 || session.request._type === 1'>
                            {{session.request.course.short_name}}
                          </span>
                          <span ng-show='session.request._type === 2' class='transform-capitalize'>
                            {{session.request.task_title}}
                          </span>
                          <span class='request-tag-status request-tag-status-completed' ng-show='session.request.status === 4'> STUDENT CANCELED </span>
                          <span class='request-tag-status request-tag-status-completed' ng-show='session.request.status === 15'> Answered </span>
                          <span class='request-tag-status request-tag-status-completed' ng-show='session.request.status
                          === 5'> CANCELED </span>
                        </p>
                        <p class='location-text' ng-show='session.request._type !== 1'> {{session.request.address}}</p>
                      </div>
                    </ion-item>
                  </div>

                </ion-list>
              </div>

        </div>

    </div>

    <div class='pure-g-c flex-column flex-space-between' ng-show='showActive'>
      <ion-scroll class='full-height' style='padding-top:1em;'>


        <ion-refresher
          pulling-icon="ion-arrow-down-c"
          spinner="circles"
          on-refresh="doRefresh()">
        </ion-refresher>

        <div class='pure-g' ng-show='user && user.pending_proposals && user.pending_proposals.length > 0'>

          <ion-list class='pure-u-1' can-swipe="true">

              <div class='guru-pending-proposal-card active-request-card-item-wrapper' ng-repeat='proposal in user.pending_proposals'>
                <ion-item class='item-avatar request-card-item' on-hold="cancelProposal(proposal)" ng-click='goToProposalRequestDetails(proposal)'>
                  <img class='pure-img' ng-src='{{img_base}}./img/verbs/{{proposal.request.verb_image}}' />
                  <div class='request-card-content relative'>
                    <p class='course-text relative'>
                      <span class="ng-class: {'card-font-small': proposal.request.course.short_name.length > 8 && proposal.request.course.short_name.length < 11, 'card-font-xs': proposal.request.course.short_name.length >= 11}"ng-show='proposal.request._type === 0 || proposal.request._type === 1'>
                        {{proposal.request.course.short_name}}
                      </span>
                      <span ng-show='proposal.request._type === 2' class='transform-capitalize'>
                        {{proposal.request.task_title}}
                      </span>
                      <span class='request-tag-status'> AWAITING RESPONSE </span>
                    </p>
                    <p class='location-text' ng-show='proposal.request._type !== 1'> {{proposal.request.address}}</p>
                  </div>
                  <!-- <i class='icon ion-chevron-right icon-small'> </i> -->
                </ion-item>

                <ion-item class='item-wrap-text' on-hold="cancelProposal(proposal)" ng-click='goToProposalRequestDetails(proposal)' ng-show='(proposal.request._type === 0 || proposal.request._type === 1) && (proposal.request.student_calendar[0].calendar_events[0].formatted || proposal.request.description.length > 0)'>
                <!-- <ion-item class='item-avatar item-wrap-text'> -->
                  <p class='request-description white-space-normal' ng-show='proposal.request._type === 0'>


                    <span ng-show='proposal.request.student_calendar &&request.student_calendar.length > 0'>

                      <strong> {{proposal.request.student_calendar[0].calendar_events[0].formatted.day}}, {{proposal.request.student_calendar[0].calendar_events[0].formatted.month}} {{proposal.request.student_calendar[0].calendar_events[0].formatted.date}}
                      </strong> between

                      <!-- not all have calendars -->
                      <span class='calendar-availability-contact'>
                        <strong>{{proposal.request.student_calendar[0].calendar_events[0].formatted.start_time_formatted}}-{{proposal.request.student_calendar[0].calendar_events[0].formatted.end_time_formatted}}</strong>
                      </span>
<!--
                      <strong> 12:00pm & 3:30pm </strong>
                      <!-- required -->
                      for <strong>{{proposal.request.student_calendar[0].calendar_events[0].formatted.time_length}} hours</strong>.
                    </span>



                     <span ng-show="proposal.request.description">
                      <strong>Description</strong>
                     </span>

                     <span ng-show='proposal.request.description && proposal.request.files.length > 0 '>
                     and
                     </span>

                      <span ng-show="proposal.request.files.length > 0">
                        <strong>Attachments</strong>
                      </span>

                      <span ng-show='proposal.request.description && proposal.request.files.length > 0 '>
                        have been added.
                      </span>
                      <span ng-show='!proposal.request.description && proposal.request.files.length > 0 '>
                        have been added.
                      </span>
                      <span ng-show='proposal.request.description && !proposal.request.files.length > 0 '>
                        has been added.
                      </span>
                  </p>
                  <p class='request-description white-space-normal' ng-show='proposal.request._type === 1'>
                    {{proposal.request.description}}
                      <br>
                      <span ng-show="proposal.request.files.length === 0">
                        <strong>Attachments</strong> have been added
                      </span>
                  </p>
                </ion-item>
              </div>

            </ion-list>


        </div>


        <div class='pure-g'>
          <!-- 1. create inset list, offset it by -5% margin-top -->
          <ion-list class='list-inset visible-overflow pure-u-1' style='margin-top:-5%; margin-bottom:10%; margin:0em !important; padding:1em; padding-top:10%;' on-hold='cancelActiveSession(session)'ng-repeat='session in user.active_guru_sessions' ng-click='goToSessionDetails(session);'>

            <!-- 2.  padding 2em h1 format bold, SemiBold, relative-->
            <ion-item class='padding-2em absolute padding-vertical-1em float-center visible-overflow center'>
              <img class='home-card-profile pure-img profile-img sidebar-img inline no-border'  src='{{session.request.student.profile_url}}'/>
              <!-- <h2> &nbsp; </h2> -->
              <h2 style='margin-top:0.5em;'>Session with <strong>{{session.request.student.name.split(' ')[0]}}</strong></h2>
            <!-- 3. Absolute positioning item, jack it from settings -->
            </ion-item>
            <!-- 4.  jack dfrom student, put hashtags, icon right-->
            <ion-item class='item-avatar item-icon-right session course-details'>
              <img class='pure-img verb-img' ng-src='{{img_base}}./img/verbs/{{session.request.verb_image}}' />
                <h2 class='uppercase'>{{session.request.course.short_name}}</h2>
                <p class='tags-wrapper'>
                  <span class='blue request-tag' ng-repeat='tag in session.request.tags'>#{{tag.name}}
                  </span>
                </p>
              <img class='icon ion-plus-custom blue custom-icon pure-img list-custom-icon request-icon' src='{{img_base}}./img/icons/paperclip-outline-blue.svg' style='margin-right: 0.33em; margin-top:0.4em;'>

            </ion-item>

            <ion-item class='item-avatar-left card-item-left'>
              <img class='icon ion-plus-custom blue custom-icon pure-img' src='{{img_base}}./img/icons/clock.svg'>
              <p class='inline'> Starts in </p>
              <p class='inline time-until' style='padding-left:1em'> {{session.request.schedule_time}} minutes </p>
            </ion-item>

            <!-- 5.  Same old but no orange> -->
            <ion-item class='item-avatar-left card-item-left'>
              <img class='icon ion-plus-custom blue custom-icon pure-img' src='{{img_base}}./img/icons/marker.svg'>
              <p class='inline'> Meet up </p>
              <p class='inline black' style='padding-left:1em'> {{session.request.address}} </p>
            </ion-item>

            <!-- 5.  Formalize list button-->
            <ion-item class='button-only' style='margin-bottom:1em;'>
              <button class='button button-full button-bright'>
                Tap to start session!
              </button>
            </ion-item>


          </ion-list>
        <!-- </div> -->
    </div>
    </ion-scroll>
  </div>
    <!-- bottom tabs -->
<div class="tabs tabs-icon-only white-bg" id='guru-tab-bar'>
  <a class="tab-item" id='home-button'>
    <img class='pure-img icon' src='{{img_base}}./img/request/house-icon-blue.svg'></i>
  </a>
  <!-- <a class="tab-item" id='guru-courses-button' ng-click='checkCourses()'>
    <img class='pure-img icon' src='{{img_base}}./img/request/guru_book_outline.svg'></i>
  </a> -->
  <a class="tab-item" href='#/guru-questions' nav-direction='swap' id='courses-button' ng-show='user.active_questions'>
    <img class='pure-img icon' src='{{img_base}}./img/icons/question.svg'></i>
  </a>
  <a class="tab-item" id='tasks-button' nav-direction='swap' href='#/guru-tasks'>
    <img class='pure-img icon' src='{{img_base}}./img/icons/task.svg'></i>
  </a>
  <a class="tab-item" id='profile-tab-button' nav-direction='swap' href='#/guru-profile'>
    <i class='icon ion-person'> </i>
  </a>
  <!-- <a class="tab-item" id='profile-tab-button' nav-direction='swap' href='#/guru-conversations'>
    <i class='icon ion-email'> </i>
  </a> -->
  <a class="tab-item" ng-click='toggleRightSideMenu()' id='settings-button'>
    <img class='pure-img icon' src='{{img_base}}./img/settings-tab-guru.svg'/>
  </a>
</div>


</ion-content>


</ion-view>
