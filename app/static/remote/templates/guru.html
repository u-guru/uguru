<ion-view hide-nav-bar='true' class='request' id='guru-home'>

  <ion-header-bar align-title="center" class='dark-bg-header item-icon-right'>
      <h1 class="title">Tasks</h1>
        <div class="buttons" ng-show='user.balance && user.balance > 0'>
          <a ng-click='goToCashOut()'>
            <i class='icon bold green font-1em'>
              ${{user.balance}}
            </i>
          </a>
        </div>
  </ion-header-bar>

<div class="tabs home-request-tabs-top tabs-top">
      <a class="tab-item uppercase blue-bg white-text">
        Your Tasks
      </a>
      <a class="tab-item uppercase opacity-1-2" ng-click='success.show(0,1000,"Coming Soon!")'>
        Previous
      </a>
</div>


<ion-content class='white-bg has-subheader' scroll='false'>


    <!-- the initial i have no tasks screen -->
    <div class='pure-g-c flex-column flex-space-between' ng-hide='user && user.pending_proposals && user.pending_proposals.length > 0' style='padding-bottom:65px;'>

        <div class='flex-item-c j-end center'>
          <div class='ranking-text-container relative font-3em'>
            <img class='pure-img absolute ranking-img' src='{{img_base}}./img/ranking/ranking_80.svg'>
            <div class='ranking-text center relative'>
              <h1 class='sans-light ranking-text-header no-margin font-300'> {{user.estimated_guru_rank || 25}} </h1>
              <h6 class='uppercase letter-spacing-small semibold opacity-1-2 percentile-text'>Percentile</h6>
              <span class='absolute uppercase th-text'>th</span>
            </div>
          </div>
        </div>


        <div class='flex-item-c j-end center'>
          <div>
            <p class='center opacity-1-3 padding-1em'>
            You can improve your ranking and make <br>
            way more money by tutoring students, <br>
            answering questions, and finishing tasks.
            </p>
            <div class='pure-u-1' style='padding-left:1em; padding-right:1em;'>
              <a href='#/ranking' nav-direction='forward' class='button button-full light-blue-bg button-footer white-text uppercase'>Increase my ranking</a>
            </div>
          </div>
        </div>
    </div>

    <div class='pure-g-c flex-column flex-space-between'>
      <ion-scroll class='full-height' style='padding-top:1em;'>


        <ion-refresher
          pulling-icon="ion-arrow-down-c"
          spinner="circles"
          on-refresh="doRefresh()">
        </ion-refresher>

        <div class='pure-g' ng-show='user && user.pending_proposals && user.pending_proposals.length > 0'>

          <ion-list class='pure-u-1' can-swipe="true">

              <div class='active-request-card-item-wrapper' ng-repeat='proposal in user.pending_proposals'>
                <ion-item class='item-avatar request-card-item' on-hold="cancelRequest(proposal.request)" ng-click='goToPendingRequestDetails(proposal.request)'>
                  <img class='pure-img' ng-src='{{img_base}}./img/verbs/{{proposal.request.verb_image}}' />
                  <div class='request-card-content relative'>
                    <p class='course-text relative'>
                      <span ng-show='proposal.request._type === 0 || proposal.request._type === 1'>
                        {{proposal.request.course.short_name}}
                      </span>
                      <span ng-show='proposal.request._type === 2' class='transform-capitalize'>
                        {{proposal.request.task_title}}
                      </span>
                      <span class='request-tag-status'> AWAITING RESPONSE </span>
                    </p>
                    <p class='location-text'> {{proposal.request.address}}</p>
                  </div>
                  <!-- <i class='icon ion-chevron-right icon-small'> </i> -->
                </ion-item>

                <ion-item class='item-wrap-text' on-hold="cancelRequest(proposal.request)" ng-click='goToPendingRequestDetails(proposal.request)' ng-show='proposal.request._type === 0 || proposal.request._type === 1'>
                <!-- <ion-item class='item-avatar item-wrap-text'> -->
                  <p class='request-description white-space-normal' ng-show='proposal.request._type === 0'>

                    <!-- required -->
                    <strong> {{proposal.request.calendar.weekday}}
                    </strong>

                    <!-- not all have calendars -->
                    <span class='calendar-availability-contact' ng-show='proposal.request.calendar.formatted_start_time'>
                       between <strong>{{proposal.request.calendar.formatted_start_time}} & {{proposal.request.calendar.formatted_end_time}}</strong>
                    </span>

                    Today between <strong> 12:00pm & 3:30pm </strong>
                    <!-- required -->
                    for <strong>3.5 hours</strong>.

                     <span ng-show="proposal.request.description">
                      <strong>Description</strong>
                     </span>

                     <span ng-show='proposal.request.description && proposal.request.files.length > 0 '>
                     and
                     </span>

                      <span ng-show="proposal.request.files.length > 0">
                        <strong>Attachments</strong>
                      </span>

                      <span ng-show='proposal.request.description && proposal.request.files.length > 0 '>
                        have been added.
                      </span>
                      <span ng-show='!proposal.request.description && proposal.request.files.length > 0 '>
                        have been added.
                      </span>
                      <span ng-show='proposal.request.description && !proposal.request.files.length > 0 '>
                        has been added.
                      </span>
                  </p>
                  <p class='request-description white-space-normal' ng-show='proposal.request._type === 1'>
                    {{proposal.request.description}}
                      <br>
                      <span ng-show="proposal.request.files.length === 0">
                        <strong>Attachments</strong> have been added
                      </span>
                  </p>
                </ion-item>
              </div>

            </ion-list>


        </div>


        <div class='pure-g'>
        <!-- <div class='flex-item-c pure-g'> -->
          <!-- 1. create inset list, offset it by -5% margin-top -->
          <ion-list class='list-inset visible-overflow pure-u-1' style='margin-top:-5%; margin-bottom:10%; padding-top:10%;' ng-repeat='session in user.active_guru_sessions' ng-click='goToSessionDetails(session);'>

            <!-- 2.  padding 2em h1 format bold, SemiBold, relative-->
            <ion-item class='padding-2em absolute padding-vertical-1em float-center visible-overflow center'>
              <img class='home-card-profile pure-img profile-img sidebar-img inline no-border'  src='{{session.request.student.profile_url}}'/>
              <!-- <h2> &nbsp; </h2> -->
              <h2 style='margin-top:0.5em;'>Session with <strong>{{session.request.student.name.split(' ')[0]}}</strong></h2>
            <!-- 3. Absolute positioning item, jack it from settings -->
            </ion-item>
            <!-- 4.  jack dfrom student, put hashtags, icon right-->
            <ion-item class='item-avatar item-icon-right session course-details'>
              <img class='pure-img verb-img' ng-src='{{img_base}}./img/verbs/{{session.request.verb_image}}' />
                <h2 class='uppercase'>{{session.request.course.short_name}}</h2>
                <p class='tags-wrapper'>
                  <span class='blue request-tag' ng-repeat='tag in session.request.tags'>#{{tag.name}}
                  </span>
                </p>
              <img class='icon ion-plus-custom blue custom-icon pure-img list-custom-icon request-icon' src='{{img_base}}./img/icons/paperclip-outline-blue.svg' style='margin-right: 0.33em; margin-top:0.4em;'>

            </ion-item>

            <ion-item class='item-avatar-left card-item-left'>
              <img class='icon ion-plus-custom blue custom-icon pure-img' src='{{img_base}}./img/icons/clock.svg'>
              <p class='inline'> Starts in </p>
              <p class='inline time-until' style='padding-left:1em'> {{session.request.schedule_time}} minutes </p>
            </ion-item>

            <!-- 5.  Same old but no orange> -->
            <ion-item class='item-avatar-left card-item-left'>
              <img class='icon ion-plus-custom blue custom-icon pure-img' src='{{img_base}}./img/icons/marker.svg'>
              <p class='inline'> Meet up </p>
              <p class='inline black' style='padding-left:1em'> {{session.request.address}} </p>
            </ion-item>

            <!-- 5.  Formalize list button-->
            <ion-item class='button-only' style='margin-bottom:1em;'>
              <button class='button button-full button-bright'>
                Tap to start session!
              </button>
            </ion-item>


          </ion-list>
        <!-- </div> -->
    </div>
    </ion-scroll>
  </div>
    <!-- bottom tabs -->
<div class="tabs tabs-icon-only white-bg" id='guru-tab-bar'>
  <a class="tab-item" id='home-button'>
    <img class='pure-img icon' src='{{img_base}}./img/request/house-icon-blue.svg'></i>
  </a>
  <!-- <a class="tab-item" id='guru-courses-button' ng-click='checkCourses()'>
    <img class='pure-img icon' src='{{img_base}}./img/request/guru_book_outline.svg'></i>
  </a> -->
  <a class="tab-item" href='#/guru-questions' nav-direction='swap' id='courses-button' ng-show='user.'>
    <img class='pure-img icon' src='{{img_base}}./img/icons/question.svg'></i>
  </a>
  <a class="tab-item" id='tasks-button' nav-direction='swap' href='#/guru-tasks'>
    <img class='pure-img icon' src='{{img_base}}./img/icons/task.svg'></i>
  </a>
  <a class="tab-item" id='profile-tab-button' nav-direction='swap' href='#/guru-profile'>
    <i class='icon ion-person'> </i>
  </a>
  <a class="tab-item" ng-click='toggleRightSideMenu()' id='settings-button'>
    <img class='pure-img icon' src='{{img_base}}./img/settings-tab-guru.svg'/>
  </a>
</div>


</ion-content>


</ion-view>
