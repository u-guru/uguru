<ion-view class='request-status' hide-nav-bar='true' cache-view='false'>

  <ion-header-bar class="header-bar header-bar-dark">

        <a class="button button-clear button-back"  nav-direction='back' href='#/guru-home'>Back</a>
        <h5 class="title uppercase">{{proposal.request.course.short_name}} Request</h5>
  </ion-header-bar>

  <ion-content scroll="false" class='guru-background'>
    <div class='pure-g-c flex-column flex-space-between'>
      <div class='margin-2em flex-item-c j-start guru-incoming-request-card'>

        <a class='item item-avatar-left item-icon-right pure-g row-details no-border guru-background' ng-show='proposal.request.student.name'>
          <img ng-src="{{proposal.request.student.profile_url}}">
          <span class='pure-u-1 white-text'>{{proposal.request.student.name.split(' ')[0]}}
          </span>
        </a>

        <div class='pure-g row-details'>
          <div class='pure-u-1-5 grey-subject-text'>Time</div>
        <div class='pure-u-4-5'> <a ng-click= 'goToStudentCalendar(proposal.student_calendar)'>See Student Availability &nbsp;&nbsp;&nbsp;<i class='icon ion-chevron-right positive icon-small'></i></a></div>
        </div>
        <div class='pure-g row-details'>
          <div class='pure-u-1-5 grey-subject-text'>Length</div>
          <div class='pure-u-4-5'>{{formatted_time_estimated_hours}} hours, {{proposal.request.time_estimate % 60}} minutes</div>
        </div>
        <div class='pure-g row-details'>
          <div class='pure-u-1-5 grey-subject-text'>Type</div>
          <div class='pure-u-4-5'>{{formatted_request_type}}</div>
        </div>
        <div class='pure-g row-details' ng-show='proposal.request.status === 1 && user.cards.length > 0'>
          <div class='pure-u-1-5 grey-subject-text'>Card Info</div>
          <div class='pure-u-4-5'>{{user.cards[0].card_last4}}, {{user.cards[0].card_type}}</div>
        </div>
        <div class='pure-g row-details'>
          <div class='pure-u-1-5 grey-subject-text'>Details</div>
          <div class='pure-u-4-5'>{{proposal.request.description}}</div>
          <div class='pure-u-1-5 grey-subject-text'></div>
          <div ng-show="proposal.request.files && proposal.request.files.length > 0" class='pure-u-4-5'><span class='opacity-3-4'><i class='icon ion-paperclip'></i>&nbsp;{{proposal.request.files.length}} Attachment </span></div>
        </div>
        <div class='pure-g row-details'>
          <div class='pure-u-1-5 grey-subject-text'>Location</div>
          <div class='pure-u-4-5'>{{proposal.request.address.split(', ').slice(0,3).join(', ')}}</div>
          <!-- <div class='pure-u-1 padding-1em'>
            <div class='map-container'>
            </div>
          </div> -->
          <div class='pure-u-1' style='margin-top:1em;'>
            <div id="map_canvas" style="height: 100px;width: 100%;">
              <ui-gmap-google-map center="map.center" control="map.control" zoom="map.zoom"  pan="true" options="options">
                <!-- <ui-gmap-search-box options="searchbox.options" template="searchbox.template" events="searchbox.events" parentdiv="searchbox.parentdiv"></ui-gmap-search-box> -->
              </ui-gmap-google-map>
            </div>
          </div>
          <div class='pure-u-1 padding-1em' ng-show='session.request.files && session.request.files.length > 0'>
            <a ng-click="openAttachment()" class='button button-stable button-full'> View Attachment </a>
          </div>
        </div>
      </div>
        <!-- <button class='button button-full button-light'> Cancel Session </button> -->
        <div class='cancel-session-container pure-g' ng-show='proposal.status === 0'>
          <div class='pure-u-1-2'>
              <button class='button button-full button-thin button-guru' ng-click='rejectStudent()'> Reject </button>
          </div>
          <div class='pure-u-1-2'>
              <button class='button button-full button-guru button-semibold' ng-click='goToConfirmProposal(proposal)'> Accept
              </button>
          </div>
        </div>
        <div class='cancel-session-container pure-g' ng-show='proposal.status === 2'>
          <div class='pure-u-1 padding-1em center white-text'>
              Proposal Accepted! We'll keep you updated
          </div>
        </div>
    </div>
  </ion-content>
</ion-view>